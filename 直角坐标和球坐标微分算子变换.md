我们有：
$$\begin{align}
 & x=r\sin \theta \cos \phi \\
 & y=r\sin \theta \sin \phi \\
 & z=r\cos \theta
\end{align}$$
我们想知道，如何从$\partial _x,\partial_{y},\partial_{z}$换成$\partial_{r},\partial_{\theta},\partial_{\phi}$或者vice versa。我们有：
$$\begin{align}
 & \partial_{x}= \frac{\partial r}{\partial x}\partial_{r}+ \frac{\partial \theta}{\partial {x}}\partial_{\theta}+ \frac{\partial \phi}{\partial x} \partial_{\phi} \\
 & \partial_{y} = \frac{\partial r}{\partial y}\partial_{r}+ \frac{\partial \theta}{\partial {y}}\partial_{\theta}+ \frac{\partial \phi}{\partial y} \partial_{\phi} \\
 & \partial_{z} =\frac{\partial r}{\partial z}\partial_{r}+ \frac{\partial \theta}{\partial {z}}\partial_{\theta}+ \frac{\partial \phi}{\partial z} \partial_{\phi}
\end{align}$$
所以我们想知道Jacobian $\frac{\partial(r,\theta,\phi)}{\partial(x,y,z)}$，其中选择$r,\theta,\phi$作为独立变量。

当然最暴力的方法是将$r,\theta,\phi$都用$x,y,z$表示，然后强行算。然后算出来的Jacobian是以$x,y,z$作为独立变量的，然后再全部换成$r,\theta,\phi$。当然，这太麻烦了。

>[!Idea]
>计算约束造成的的微分关系约束比直接计算约束简单

所以我们有微分关系：
$$\begin{align}
 & dx=\sin \theta \cos \phi dr+r\cos \theta \cos \phi d\theta-r\sin \theta \sin \phi d\phi \\
 & dy=\sin \theta \sin \phi dr+r\cos \theta \sin \phi d\theta+r\sin \theta \cos \phi d\phi \\
 & dz=\cos \theta dr-r\sin \theta d\theta
\end{align}$$
比如说我们想计算$\frac{\partial r}{\partial x}$，这其实就是在计算$\left( \frac{\partial r}{\partial x} \right)_{y,z}$。所以我们在令$dy,dz=0$时解出$dr$即可。

或者还有更暴力一点的方式。即直接算逆矩阵。我们有：
$$\begin{pmatrix}
dx \\
dy \\
dz
\end{pmatrix}=\begin{pmatrix}
\sin \theta \cos \phi & r\cos \theta \cos \phi & -r\sin \theta \sin \phi \\
\sin \theta \sin \phi & r\cos \theta \sin \phi & r\sin \theta \cos \phi \\
\cos \theta & -r\sin \theta & 0
\end{pmatrix}\begin{pmatrix}
dr \\
d\theta \\
d\phi
\end{pmatrix}$$
可以算得：
$$\begin{pmatrix}
dr \\
d\theta \\
d\phi
\end{pmatrix}=\begin{pmatrix}
\cos \phi \sin \theta & \sin \theta \sin \phi & \cos \theta \\
\frac{\cos \theta \cos \phi}{r} & \frac{\cos \theta \sin \phi}{r} & - \frac{\sin \theta}{r} \\
- \frac{\csc \theta \sin \phi}{r} &  \frac{\cos \phi \csc \theta}{r} & 0
\end{pmatrix} \begin{pmatrix}
dx \\
dy \\
dz
\end{pmatrix}$$
容易解得；
$$\begin{align}
 & \partial_{x}  = \cos \phi \sin \theta \partial_{r}+ \frac{1}{r}\cos \theta \cos \phi \partial_{\theta}- \frac{1}{r}\csc \theta \sin \phi \partial_{\phi} \\
 & \partial_{y}= \sin \theta \sin \phi+ \frac{1}{r} \cos \theta \sin \phi \partial_{\theta}+ \frac{1}{r} \cos \phi \csc \theta \partial_{\phi} \\
 & \partial_{z}= \cos \theta \partial_{r}- \frac{1}{r}\sin \theta \partial_{\theta}
\end{align}$$
## Ex:
有了上述微分关系之后，容易算得：
$$\begin{align}
 & L_{z}= -i\hbar(x\partial_{y}-y\partial_{x})=-i\hbar \partial_{\phi} \\
 & L_{x}= -i\hbar(y\partial_{z}-z\partial_{y})=i\hbar(\sin \phi \partial_{\theta}+\cot \theta \cos \phi \partial_{\phi}) \\
 & L_{y}=-i\hbar(z\partial_{x}-x\partial_{z})=i\hbar(-\cos \phi \partial_{\theta}+\cot\theta \sin \phi \partial_{\phi})
\end{align}$$


