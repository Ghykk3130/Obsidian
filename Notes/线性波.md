# 1. 无旋流动

我们先来研究什么时候流体是无旋的。为此，先证明vorticity equation：

>[!Success] Proposition 1.1
>For an incompressible inviscid fluid, we have:
>$$\frac{D\boldsymbol{\omega}}{Dt}=\boldsymbol{\omega}\cdot \nabla \mathbf{u}$$
## Proof.
$$\begin{align}
 & \frac{\partial \mathbf{u}}{\partial t}+\mathbf{u}\cdot \nabla \mathbf{u}=- \frac{\nabla p}{\rho}+\nabla \psi \\
\implies &  \frac{\partial \mathbf{u}}{\partial t}+\nabla\left( \frac{1}{2}u^{2} \right)-\mathbf{u}\times(\nabla \times \mathbf{u})=- \frac{\nabla p}{\rho}-\nabla \psi \\
\implies &  \frac{\partial \mathbf{u}}{\partial t}+ \nabla\left( \frac{1}{2}u^{2}+ \frac{p}{\rho}+\psi  \right)=\mathbf{u}\times \boldsymbol{\omega} \\
\implies & \frac{\partial \boldsymbol{\omega}}{\partial t}=\nabla \times(\mathbf{u}\times \boldsymbol{\omega})=\boldsymbol{\omega}\cdot \nabla \mathbf{u}+\mathbf{u}\nabla \cdot \boldsymbol{\omega}-\boldsymbol{\omega}\nabla \cdot\mathbf{u}-\mathbf{u}\cdot \nabla \boldsymbol{\omega}=\boldsymbol{\omega}\cdot \nabla \mathbf{u}-\mathbf{u}\cdot \nabla \boldsymbol{\omega} \\
\implies & \frac{D\boldsymbol{\omega}}{Dt}=\boldsymbol{\omega}\cdot \nabla \mathbf{u}
\end{align}$$
>[!Right]
>$\blacksquare$
## Ex:

考虑液体位置向量场经历small amplitude oscillation。那么$\nabla \mathbf{u}$为小量。若初始$\boldsymbol{\omega}=0$，假设$\boldsymbol{\omega}$稍稍偏移$0$，由于$\nabla \mathbf{u}$是小量，可以近似认为$\frac{D\boldsymbol{\omega}}{Dt}=0 \text{ to the first order}$。


>[!Success] Proposition 1.2
>Consider an incompressible inviscid fluid. If $\boldsymbol{\omega}=0\text{ at }t=0$, then $\boldsymbol{\omega}(t)=0\text{ for }t>0$.
## Proof.

It suffices to show $||\boldsymbol{\omega}||_{2}=0$。我们已知：
$$||\boldsymbol{\omega}||_{2}^{2}= \int_{\mathbb{R}^{3}}d^{3}r\omega^{2}\geq 0$$
那么it suffices to show $||\boldsymbol{\omega}|_{}|_{2}^{2}\leq 0$。为了找到上界，我们运用vorticity equation。但vorticity equation是微分方程，怎么应用呢？因为初始$\boldsymbol{\omega}=0$，我们只需要证明$\frac{d}{dt}||\boldsymbol{\omega}||^{2}_{2}\leq 0$即可。我们有：
$$\begin{align}
  \frac{d}{dt}\int_{\mathbb{R}^{3}}d^{3}r\omega^{2} &  = \int d^{3}r \frac{D\omega^{2}}{Dt}  \\
 & =2\int d^{3}r\boldsymbol{\omega}\cdot \frac{D\boldsymbol{\omega}}{Dt} \\
 & =2\int d^{3}r \boldsymbol{\omega}\cdot(\boldsymbol{\omega}\cdot \nabla \mathbf{u})
  \\
 & = 2 \sum_{i,j} \int d^{3}r \omega_{i}\omega_{j}\partial_{j}u_{i}
\end{align}$$
令$M=sup_{\mathbb{R}^{4}}(|\partial_{j}u_{i}|)< \infty$。那么：
$$\begin{align}
 & \sum_{i,j}\int d^{3}r\omega_{i}\omega_{j}\partial_{j}u_{i}\leq \sum_{i,j}\int d^{3}r|\omega_{i} ||\omega_{j}||\partial_{j}u_{i} |\leq M \sum_{i,j} \int d^{3}r|\omega_{i}||\omega_{j}|=M\int d^{3}r\left( \sum_{i}|\omega_{i}| \right)\left( \sum_{j}|\omega_{j}| \right)=M\int d^{3}r\left( \sum_{i}|\omega_{i}| \right)^{2}
\end{align}$$
由Holder不等式，我们有：
$$\begin{align}
 & \left( \sum_{i}1 \cdot |\omega_{i}| \right)^{2} \leq\left( \sum_{i}1^{2} \right)\left( \sum_{i}\omega_{i}^{2} \right)=3\omega^{2}  
\end{align}$$
故：
$$\begin{align}
 & \frac{d}{dt}||\boldsymbol{\omega}||_{2}^{2}\leq 6M ||\boldsymbol{\omega}||_{2}^{2} \\
\implies & e^{6Mt} \frac{d}{dt} ||\boldsymbol{\omega}||_{2}^{2}\leq 6M e^{6Mt}||\boldsymbol{\omega}||_{2}^{2} \\
\implies  & \frac{d}{dt}(e^{6Mt}||\boldsymbol{\omega}||_{2}^{2})\leq 0
\end{align}$$
注意到$$(e^{6Mt}||\boldsymbol{\omega}||_{2}^{2})|_{t=0}=0$$
于是$||\boldsymbol{\omega}||_{2}^{2}\leq 0$。
>[!Right]
>$\blacksquare$
# 2. 自由边界条件

我们先定义拓扑空间上的homeomorphism。

>[!Note] Definition 2.1
>Let $M,N$ be topological spaces. $f:M \rightarrow N$ is a homeomorphism if $f$ is bijective, and $f,f^{-1}$ are continuous.

我们可以证明：

>[!Success] Proposition 2.1
>Let $f:M\rightarrow N$ be a homeomorphism. Then:
>$$f(\partial A)=\partial f(A),\ \forall A\subset M$$
## Proof.

首先证明$f(\bar{A})=\overline{f(A)}$。
$$\overline{f(A)}\text{ closed}\implies f^{-1}(\overline{f(A)})\text{ closed,\ }f^{-1}(\overline{f(A)}) \supset A\implies \bar{A} \subset f^{-1}(\overline{f(A)})\implies f(\bar{A})\subset f^{-1}(\overline{f(A)})$$
同理：
$$\bar{A}\text{ closed}\implies f(\bar{A})\text{ closed, }f(A)\subset  f(\bar{A})\implies\overline{f(A)}\subset f(\bar{A})$$
Then done。接下来证明$f(A^{\circ})=f(A)^{\circ}$。
$$A^{\circ}\text{ open}\implies f(A^{\circ})\text{ open, }f(A^{\circ})\subset f(A)\implies f(A^{\circ})\subset f(A)^{\circ}$$
同理：
$$f(A)^{\circ}\text{ open}\implies f^{-1}(f(A)^{\circ})\text{ open, }f^{-1}(f(A)^{\circ}) \subset A \implies f^{-1}(f(A)^{\circ})\subset A^{\circ}\implies f(A)^{\circ}\subset f(A^{\circ})$$
Then done。接下来：
$$\begin{align}
f(\partial A) & = f(\bar{A} \backslash A^{\circ} ) \\
 & = f(\bar{A})\backslash f(A^{\circ}) \\
 & = \overline{f(A)}\backslash f(A)^{\circ} \\
 & =\partial f(A)
\end{align}$$
其中第一步到第二步是因为bijectivity。
>[!Right]
>$\blacksquare$

考虑$\mathbb{R}^{3}$中的无粘性流。令$h=h(x,y,t)$为流体边界，外面是空气。定义：
$$F(\mathbf{r},t)=z-h(x,y,t)$$
则流体边界为$F=0$。因为flow map是同胚，所以追踪$F=0$上的一点，随时间演化仍然保持$F=0$。即：
$$\frac{DF}{Dt}=0\text{ for a point on the boundary}$$
那么：
$$\begin{align}
 & \frac{DF}{Dt}= \frac{\partial F}{\partial t}+\mathbf{u}\cdot \nabla F=0 \\
\implies  & w= \frac{\partial h}{\partial t}+u \frac{\partial h}{\partial x}+ v \frac{\partial h}{\partial y} \text{ on the boundary}
\end{align}$$
导出一个边界条件。 现在考虑穿过流体和大气的一个小盒$V$。
![[Drawing 2026-02-12 22.23.34.excalidraw|center|300]]
牛顿第二定律有：
$$\begin{align}
\int_{V}d^{3}r \rho \frac{D\mathbf{u}}{Dt}=\int_{\text{upper half}}d\mathbf{S} p_{0}+ \int_{\text{lower half}}d\mathbf{S}p+\int_{V}d^{3}r\rho \mathbf{g}
\end{align}$$
令侧面积$\rightarrow 0$，那么：

>[!Quote] Idea 2.1
>由于$\frac{D\mathbf{u}}{Dt},\ \rho \mathbf{g}$都是有界函数，在体积趋近于零时，这两个积分趋近于零。但是压强的积分由于是面积分，体积趋于令时，上下两个表面积并不趋于零，所以积分不趋于零。

压强在侧面的积分也趋于零。只留下上下表面积分：
$$\begin{align}
 & \int_{\text{upper surface}} d\mathbf{S}p_{0}+\int_{\text{lower surface}}d\mathbf{S}p=0 \\
 \implies & dSp_{0}-dSp=0 \\
\implies & p=p_{0} \text{ on the boundary}
\end{align}$$

所以我们获得边界条件：

>[!Success] Proposition 2.2
>For an inviscid flow, we have the boundary conditions:
>$$\begin{align}
 & w= \frac{\partial h}{\partial t}+ u \frac{\partial h}{\partial x}+ v \frac{\partial h}{\partial y}= \frac{Dh}{Dt} \text{ on the boundary}\\
 & p=p_{0} \text{ on the boundary}
\end{align}$$
## Ex:

考虑静流体。以流体面为$z=0$。那么有Euler方程：
$$\begin{align}
 & -\nabla p+\rho \mathbf{g}=0 \\
\implies & p(z)=p(z=0)-\rho gz
\end{align}$$
代入边界条件得到：
$$p(z)=p_{0}-\rho gz$$

# 3. 线性波

考虑密度为常量的不可压缩无旋流。那么可以定义速度势$\mathbf{u}=\nabla \phi$。那么有Laplace方程：
$$\nabla \cdot \mathbf{u}=0\implies \nabla^{2}\phi=0$$
考虑流体在三维空间中，如同海一样铺开在一个底上。令流体静止时高度为$H$。将$H$处设为$z$轴原点。

我们考虑边界条件。对于压强连续，我们不是很方便直接计算压强。我们积分：
$$\begin{align}
 & \rho \left( \frac{\partial \mathbf{u}}{\partial t}+\mathbf{u}\cdot \nabla \mathbf{u} \right)=- \nabla p- \rho \nabla \psi \\
\implies &  \rho \left( \frac{\partial \mathbf{u}}{\partial t}+ \nabla\left( \frac{1}{2}u^{2} \right)-\mathbf{u}\times \boldsymbol{\omega} \right) = -\nabla p- \rho \nabla \psi \\
\implies &  \nabla\left( \frac{1}{2}\rho |\nabla \phi|^{2}+ \rho \frac{\partial \phi}{\partial t} +p+\rho \psi  \right)=0
\end{align}$$
Fix $t$，沿空间积分得到：
$$\frac{1}{2}\rho|\nabla \phi|^{2}+\rho  \frac{\partial \phi}{\partial t} +p+\rho \psi=f(t)$$
若在地球表面，则$\psi=gz$。在boundary上得到：
$$\frac{1}{2}\rho|\nabla \phi|^{2}+\rho  \frac{\partial \phi}{\partial t} +p_{0}+\rho g h=f(t)\text{ at }z=h$$
在海底有速度连续：
$$w= \partial_{z}\phi=0\text{ at }z=-H$$
在海面也有速度连续：
$$\begin{align}
 & \partial_{z}\phi= \frac{\partial h}{\partial t}+ (\partial _{x}\phi)\partial_{x}h+ (\partial_{y}\phi)\partial_{y}h\text{ at }z=h
\end{align}$$
假设$h\ll 1,\  \partial_{x}h,\ \partial_{y}h\ll 1$，$\partial_{x}\phi,\ \partial_{y}\phi,\ \partial^{}_{z}\phi \ll 1$，$\partial_{x}h,\ \partial_{y}h,\ \partial_{x}\phi,\ \partial_{y}\phi,\ \partial_{z}\phi$的任意阶时空导也为小量。我们忽略二阶小量，得到：
$$\begin{align}
 & \partial_{t}\phi|_{z=h}\approx \partial_{t}\phi|_{z=0}+\partial_{zt}\phi|_{z=0}h\approx \partial_{t}\phi|_{z=0} 
\end{align}$$
那么
$$\begin{align}
 &  \frac{1}{2}\rho|\nabla \phi |^{2}+\rho \frac{\partial \phi}{\partial t}+p_{0}+\rho gh=f(t)\implies \frac{\partial \phi}{\partial t}+gh\approx f^{'}(t)\text{ at }z=0\text{ where }f^{'}(t)= \frac{f(t)-p_{0}}{\rho}  \end{align}
 $$
我们将$f^{'}$写作$f$，得到：
$$\partial_{t}\phi+gh= f(t)\text{ at }z=0$$
另外：
$$\partial_{z}\phi|_{z=h}\approx \partial_{z}\phi|_{z=0}+ h(\partial^{2}_{z}\phi)|_{z=0}\approx \partial_{z}\phi|_{z=0}$$
所以：
$$\begin{align}


  \partial_{z}\phi= \frac{\partial h}{\partial t}+ (\partial_{x}\phi)\partial_{x}h+ (\partial_{y}\phi)\partial_{y}h\implies \partial_{z}\phi= \partial_{t}h \text{ at }z=0
\end{align}$$
于是我们获得近似后的边界条件：
$$\begin{align}
 & \frac{\partial \phi}{\partial t}+gh= f^{}(t)\text{ at }z=0 \\
 & \partial_{z}\phi=0 \text{ on the seabed} \\
 & \partial_{z}\phi=\partial_{t}h\text{ at }z=0
\end{align}$$
>[!Quote] Idea 3.1
>构造任何势的时候，应该考虑规范自由度。选取合适的规范可以大幅度化简问题。

我们注意到速度势具有规范自由度。任意加上时间的函数：
$$\phi(\mathbf{r},t) \leadsto \phi(\mathbf{r},t)+ \Lambda(t)$$
不会影响物理速度$\mathbf{u}=\nabla \phi$。我们选取规范以至于：
$$\frac{\partial \phi}{\partial t}+gh=0\text{ at }z=0$$
其余两个边界条件显然不受影响。

>[!Tip] 
>We propose the boundary conditions after approximation:
>$$\begin{align}
 & \frac{\partial \phi}{\partial t}+gh=0\text{ at }z=0 \\
 & \partial_{z}\phi=0\text{ at }z=-H \\
 & \partial_{z}\phi=\partial_{t}h\text{ at }z=0
\end{align}$$

接下来我们作FT来解Laplace方程。

>[!Quote] Idea 3.2
>我们一个naive的想法是，对于所有空间变量和时间变量作FT，即：
>$$\phi(\mathbf{r},t)= \int d^{3}k \tilde{\phi}(\mathbf{k},\omega)e^{i(\mathbf{k}\cdot \mathbf{r}-\omega t)}$$
>但这样是不对的。由于$z$是有界的，我们不能对$z$作连续FT。
>
>我们试想对于$z$作连续FT会发生什么。固定$x,y,t$，我们作：
>$$\phi=\int_{\mathbb{R}}dk_{z}\tilde{\phi}e^{ik_{z}z}$$
>那么我们试图得到$\tilde{\phi}$时会失败：
>$$\begin{align}
 & \int_{D}dz \phi e^{-ik_{z}^{'}z}= \int_{\mathbb{R} }dk_{z} \int_{D}dz \tilde{\phi} e^{i(k_{z}-k_{z}^{'})z}
\end{align}$$
其中$D$有界。那么就不能得到$\int_{D}dze^{i(k_{z}-k_{z}^{'})z}=2\pi\delta(k_{z}-k_{z}^{'})$。
>
>为了解决这个问题，接下来可能会想将$\phi$延拓到整个$\mathbb{R}$，规定$D$以外的$\phi=0$。这样一来虽然上述步骤不会fail，但是Laplace方程就不一定能在$z \not\in D$区域内满足，同样也无法解方程。
由于$z$的boundary不固定，也不方便作离散FT。那么我们不对$z$作FT。 我们令：

由于$z$的boundary不固定，也不方便作离散FT。那么我们不对$z$作FT。 我们令：
$$\phi(x,y,z,t)= \int_{\mathbb{R}^{3}}dk_{x}dk_{y}d\omega \tilde{\phi}(k_{x},k_{y},z,\omega)e^{i(k_{x}x+k_{y}y-\omega t)}$$那么：
$$\nabla^{2}\phi=0\implies \partial_{z}^{2}\tilde{\phi}=(k_{x}^{2}+k_{y}^{2})\tilde{\phi}$$容易解得：
$$\tilde{\phi}=Ae^{kz}+B e^{-kz}\text{ where }k=\sqrt{ k_{x}^{2}+k_{y}^{2} }$$考虑边界条件：
$$\partial_{z}\phi=0\text{ on the seabed}\implies \partial_{z}\tilde{\phi}=0\text{ at }z=-H$$重写系数得到：
$$\tilde{\phi}=A \cosh(k(z+H))$$考虑其余两个边界条件：
$$\begin{align}

 & \partial_{z}\phi=\partial_{t}h\text{ at }z=0\implies \partial_{z}\tilde{\phi}=-i\omega \tilde{h}\text{ at }z=0 \

 & \partial_{t}\phi+gh=0\text{ at }z=0\implies -i\omega \tilde{\phi}+g\tilde{h}= 0\text{ at }z=0

\end{align}$$
由于$\tilde{f}$不是$z$的函数，那么：
$$\begin{align}

 & \partial_{z}\tilde{\phi}=-i\omega \tilde{h} \text{ at }z=0\

 & \tilde{\phi}= \frac{g}{i\omega}\tilde{h}\text{ at }z=0

\end{align}$$
那么：
$$\partial_{z}\tilde{\phi}|_{z=0}= \frac{\omega^{2}}{g}\tilde{\phi}|_{z=0}\implies \omega^{2}=kg \tanh(kH)$$

> [!Success] Proposition 3.1
> 
> The dispersion relation is:
> 
> $$\omega^{2}=kg\tanh(kH)\text{, where }k=\sqrt{ k_{x}^{2}+k_{y}^{2} }$$

接下来，若给定初始条件，我们就可以解出$\phi$。


接下来我们考虑群速度与相速度。令$\tilde{\phi}$在$\mathbf{k}=\mathbf{k}_{0}$ peak，并且峰很窄。那么在附近一阶近似得到：
$$\begin{align}
 & \omega(\mathbf{k})\approx\omega(k_{0})+ \frac{\partial \omega}{\partial \mathbf{k}}\cdot\delta \mathbf{k}
\end{align}$$
于是：
$$\begin{align}
\phi & = \int d^{2}k^{}d\omega \tilde{\phi}\exp(i(\mathbf{k}\cdot \boldsymbol{\rho}-\omega t))\text{ where }\boldsymbol{\rho}=(x,y) \\
 & = \int d^{2}k^{}d\omega \tilde{\phi}\exp\left( i\left( \delta \mathbf{k}\cdot \boldsymbol{\rho}+\mathbf{k}_{0}\cdot \boldsymbol{\rho}-\omega(\mathbf{k}_{0})t- \frac{\partial \omega}{\partial \mathbf{k}}\cdot\delta \mathbf{k} t\right) \right) \\
 & = e^{i\mathbf{k}_{0}\cdot \boldsymbol{\rho}-i\omega(\mathbf{k}_{0} )t} \int d^{2}k d\omega \tilde{\phi}\exp\left( i\left( \delta \mathbf{k}\cdot \boldsymbol{\rho}- \frac{\partial \omega}{\partial \mathbf{k}}\cdot\delta \mathbf{k} t\right) \right) \\
 & = e^{i\mathbf{k}_{0}\cdot \boldsymbol{\rho}-i\omega(\mathbf{k}_{0})t}\int d^{2}(\delta k) d\omega \tilde{\phi}\exp\left( i\left( \delta \mathbf{k}\cdot \boldsymbol{\rho}- \frac{\partial \omega}{\partial \mathbf{k}}\cdot\delta \mathbf{k}t \right) \right)
\end{align}$$
因为$\delta k$很小，所以对应的波长很长，那么可以将后面积分部分当做包络。考虑构成包络的波的等相位点：
$$\begin{align}
 & \delta \mathbf{k}\cdot \boldsymbol{\rho}- \frac{\partial \omega}{\partial \mathbf{k}}\cdot\delta \mathbf{k}t=\text{const.}   \\
\implies &  d\boldsymbol{\rho}\cdot\delta \mathbf{k}- \frac{\partial \omega}{\partial \mathbf{k}}\cdot \delta \mathbf{k}dt=0,\ \forall\delta \mathbf{k}\text{ around }\mathbf{k}_{0} \\
\implies & d\boldsymbol{\rho}- \frac{\partial \omega}{\partial \mathbf{k}}dt=0\\
\implies & \frac{d\boldsymbol{\rho}}{dt}= \left.\frac{\partial \omega}{\partial \mathbf{k}}\right|_{\mathbf{k}=\mathbf{k}_{0}}
\end{align}$$这即是改变$t$，造成等相位点的移动$d\boldsymbol{\rho}$。等称为群速度。考虑$e^{i\mathbf{k}_{0}\cdot \boldsymbol{\rho}-i\omega(\mathbf{k}_{0})t}$的等相位面：
$$\begin{align}
 & \mathbf{k}_{0}\cdot \boldsymbol{\rho}- \omega(\mathbf{k}_{0})t=\text{const.} \\ \implies &  \mathbf{k}_{0}\cdot d\boldsymbol{\rho}-\omega(\mathbf{k}_{0})dt=0 \\

\implies & \frac{d\boldsymbol{\rho}}{dt} \cdot \frac{\mathbf{k}_{0}}{k_{0} }= \frac{\omega(\mathbf{k}_{0})}{k_{0}}
\end{align}$$
这即是改变$t$，等相位面之间的距离的变化$d\boldsymbol{\rho}\cdot \frac{\mathbf{k}_{0}}{k_{0}}$除以$dt$，称为相速度。

## Ex:

接下来我们可以得到相速度：
$$v_{p}= \left.\frac{\omega}{k}\right|_{\mathbf{k}=\mathbf{k}_{0}}=\sqrt{ \frac{g}{k_{0}} \tanh(k_{0}H)}$$
以及群速度：
$$v_{g}= \left.\frac{\partial \omega}{\partial k}\right|_{\mathbf{k}=\mathbf{k}_{0}}$$
注意到$v_{p}$随着$k_{0}$单减。所以peak处波长越大相速度越大。若$Hk_{0} \gg 1$，得到深水波相速度$v_{p}=\sqrt{ \frac{g}{k_{0}} }$。若$Hk_{0} \ll 1$，得到浅水波相速度$v_{p}=\sqrt{ gH }$。

同理，还容易计算深水波群速度：
$$\omega \approx \sqrt{ kg }\implies v_{g}= \frac{1}{2}\sqrt{ \frac{g}{k_{0}} }= \frac{1}{2}v_{p}$$
还有浅水波群速度：
$$\omega \approx k\sqrt{ gH }\implies v_{g}=\sqrt{ gH }=v_{p}$$
# 4. Some physical insights

为了获得一些物理直觉，我们考虑二维空间中的流。我们有：
$$\nabla^{2}\phi=0$$
以及边界条件：
$$\begin{align}
 & \partial_{y}\phi=0\text{ at }y=-H \\
 & \partial_{y}\phi=\partial_{t}h\text{ at }y=0 \\
 & \partial_{t}\phi+gh=0\text{ at }y=0
\end{align}$$
我们提出Fourier试探解：
$$\phi=\phi_{0}(y) \exp(i(kx-\omega t))$$
>[!Quote] Idea 4.1
>Fourier试探解其实就是Fourier变换假设了$\tilde{\phi}(k^{'},\omega^{'},y)=\delta(k^{'}-k)\delta(\omega^{'}-\omega)A(y)$，只有一个频率的峰。

那么：
$$\begin{align}
 & \nabla^{2}\phi=0\implies \partial_{yy}\phi_{0}=k^{2}\phi_{0}\implies \phi_{0}(y)=Ae^{ky}+Be^{-ky}
\end{align}$$
然后：
$$\partial_{y}\phi=0\text{ at }y=-H\implies \phi_{0}(y)=A\cosh(k(y+H))$$
于是：
$$\begin{align}
\left.\begin{aligned}
 & \partial_{y}\phi=\partial_{t}h\text{ at y=0} \\
 & \partial_{t}\phi+gh=0\text{ at }y=0
\end{aligned}\right\}\implies \omega^{2}=kg\tanh(kH)
\end{align}$$
得到色散关系。容易解得速度势：
$$\phi=A\cosh(k(y+H))e^{i(kx-\omega t)}$$
求梯度取实部得到速度场：
$$\begin{align}
\mathbf{u}=Ak\begin{pmatrix}-
\cosh(k(y+h))\sin(kx-\omega t) \\
\sinh(k(y+h))\cos(kx-\omega t)
\end{pmatrix}
\end{align}$$
假设流体粒子$t$时刻距离$0$时刻位置很近。那么：
$$\mathbf{u}=Ak\begin{pmatrix}
-\cosh(k(y_{0}+h))\sin(kx_{0}-\omega t) \\
\sinh(k(y_{0}+h))\cos(kx_{0}-\omega t)
\end{pmatrix}$$
积分得到pathline：
$$\mathbf{r}=- \frac{Ak}{\omega}\begin{pmatrix}
\cosh(k(y_{0}+h))\cos(kx_{0}-\omega t) \\
\sinh(k(y_0+h))\sin(kx_{0}-\omega t)
\end{pmatrix}+\mathbf{r}_{0}$$
这显然是一个椭圆：
$$\frac{(x-x_{0})^{2}}{\left[ \frac{Ak}{\omega} {\cosh(k(y_{0}+h))} \right]^{2}}+ \frac{(y-y_{0})^{2}}{\left[ \frac{Ak}{\omega} {\sinh(k(y_{0}+h))} \right]^{2}}=1$$
越靠近海底，椭圆长短轴都越小，几乎是指数衰减，并且椭圆越扁平。$h$越大，椭圆长短轴越大。若取$h\rightarrow \infty$，显然长轴短轴相同，得到圆形pathline。

The representative pathlines are drawn for $k=1,h=1,A=0.5,g=9.8$
![[Pasted image 20260214230535.png|center|500]]

# 5. 表面张力的影响

考虑水与空气分层界面存在表面张力$\gamma$。那么：
$$p-p_{0}=-\gamma \nabla^{2}h\text{ at }z=h$$
那么压力连续边界条件修改为：
$$\partial_{t}\phi+ gh- \frac{\gamma}{\rho}\nabla^{2}h=0\text{ at }z=0$$
我们考虑Fourier试探解：
$$\phi=\phi_{0}(y)e^{i(kx-\omega t)},\ h= h_{0}(y)e^{i(kx-\omega t)}$$
那么Laplace方程和边界条件变为：
$$\begin{align}
 & \partial_{yy}\phi_{0}=k^{2}\phi_{0} \\
 & -i\omega \phi_{0}+gh_{0}+ \frac{\gamma}{\rho}k^{2}h_{0}=0\text{ at }z=0 \\
 & \partial_{y}\phi_{0}=0\text{ at }z=-H \\
 & \partial_{y}\phi_{0}= -i\omega h_{0}\text{ at z=0}
\end{align}$$
将$g+ \frac{\gamma k^{2}}{\rho}$看做整体，则和没有表面张力的结果一样。于是得出色散关系：
$$\omega^{2}=k\left( g+ \frac{\gamma k^{2}}{\rho} \right)\tanh(kH)$$
若$\frac{\gamma k^{2}}{\rho}\gg g$，则称波为capillary wave。
## Ex:

考虑相速度：
$$v_{p}= \frac{1}{k}\sqrt{ k\left( g+ \frac{\gamma k^{2}}{\rho} \right)\tanh(kH) }$$
存在表面张力时相速度要快一些。考虑capillary wave，$kH \gg 1$，我们有：
$$v_{p}= \sqrt{ \frac{k\gamma}{\rho }}$$
我们可以求出群速度。尽管纯粹平面波的群速度没有物理意义，但是我们总是可以想象频率空间存在有限FWHM，以至于群速度有意义。
$$v_{g}= \frac{3}{2} \sqrt{ \frac{k\gamma}{\rho} }= \frac{3}{2}v_{p}$$








