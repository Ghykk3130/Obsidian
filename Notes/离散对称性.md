# 1. Parity

考虑系统波函数$\psi(\vec{r})$。若对于整个系统作物理空间的宇称$-1$，可以得到新的波函数$\psi^{'}(\vec{r})$。则有：
$$\psi^{'}(\vec{r})=\psi(-\vec{r})$$
我们记$\ket{\psi^{'}}=\pi \ket{\psi}$，则有：
$$\bra{\vec{r}} \pi \ket{\psi} =\bra{-\vec{r}} \psi\rangle$$
容易证明$\pi$是$-1$在Hilbert空间的homomorphism。

>[!Note] Definition 1.1
>Define the parity operator $\pi$:
>$$\bra{\vec{r}} \pi \ket{\psi} =\bra{-\vec{r}} \psi\rangle,\ \forall \ket{\psi} $$
## Ex:

若$\psi(\vec{r})$为奇函数，则：
$$\bra{\vec{r}} \pi \ket{\psi} =\bra{-\vec{r}} \psi\rangle=-\bra{\vec{r}} \psi\rangle\implies \pi \ket{\psi} =-\ket{\psi} $$
称$\ket{\psi}$具有奇宇称。若$\psi(\vec{r})$为偶函数，则：
$$\bra{\vec{r}} \pi \ket{\psi} =\bra{-\vec{r}} \psi\rangle=\bra{\vec{r}} \psi\rangle\implies \pi \ket{\psi} =\ket{\psi} $$
称$\ket{\psi}$具有偶宇称。

>[!Success] Proposition 1.1
>$\pi$ is Hermitian.
## Proof.

STS：$\bra{\phi}\pi \ket{\psi}=\bra{\phi}\pi ^{\dagger}\ket{\psi},\ \forall \ket{\phi},\ket{\psi}$。我们有：
$$\begin{align}
\bra{\phi} \pi \ket{\psi}  & = \int d^{3}r \bra{\phi} \mathbf{r}\rangle\bra{\mathbf{r}} \pi \ket{\psi}  \\
 & = \int d^{3}r \phi ^{*}(\mathbf{r})\psi(-\mathbf{r}) \\
 & = \int d^{3}r \phi ^{*}(-\mathbf{r})\psi(\mathbf{r}) \\
 & = \int d^{3}r \bra{\phi} \pi ^{\dagger}\ket{\mathbf{r}} \bra{\mathbf{r}} \psi\rangle \\
 & = \bra{\phi} \pi ^{\dagger}\ket{\psi} 
\end{align}$$
>[!Right]
>$\blacksquare$

>[!Success] Proposition 1.2
>$\pi^{2}=1$
## Proof.

$$\bra{\mathbf{r}} \pi^{2}\ket{\psi} =\bra{-\mathbf{r}} \pi \ket{\psi} =\bra{\mathbf{r}} \psi \rangle\implies \pi^{2}\ket{\psi} =\ket{\psi } \implies \pi^{2}=1$$
>[!Right]
>$\blacksquare$

一些基本动力学算符在宇称下有变换规则。假设：
$$\bra{\psi} \pi ^{\dagger}\mathbf{r}\pi \ket{\psi} =-\bra{\psi} \mathbf{r}\ket{\psi} $$
则：
$$\pi ^{\dagger}\mathbf{r}\pi=-\mathbf{r}$$
>[!Note] Postulate 1.1
>Assume the transformation law of $\mathbf{r}$ is:
>$$\pi ^{\dagger}\mathbf{r}\pi=-\mathbf{r}$$

可以得到动量算符的变换规则：

>[!Success] Proposition 1.3
>The transformation law of $\mathbf{p}$ is:
>$$\pi ^{\dagger}\mathbf{p}\pi=-\mathbf{p}$$
## Proof.

显然在物理空间中，先平移再对称等于先对称再反向平移。映射到Hilbert空间中得到：
$$T(d\mathbf{r})\pi \ket{\psi} =\pi T(-\mathbf{d}r) \ket{\psi} $$
于是：
$$\begin{align}
 & T(d\mathbf{r})\pi=\pi T(-d\mathbf{r}) \\
\implies & \left( 1- \frac{i}{\hbar}\mathbf{p}\cdot d\mathbf{r} \right)\pi=\pi\left( 1+ \frac{i}{\hbar } \mathbf{p}\cdot d\mathbf{r} \right) \\
\implies & \pi ^{\dagger}\mathbf{p}\pi=-\mathbf{p}
\end{align}$$
>[!Right]
>$\blacksquare$
# 2. 晶体的平移对称性

考虑一个Bravais晶体$\Lambda=\{ \mathbf{R} \}$。考虑将处于$\ket{\psi}$的系统平移$\mathbf{R}$得到新态$\ket{\psi^{'}}$。则：
$$\psi^{'}(\mathbf{r})=\psi(\mathbf{r}-\mathbf{R})$$
于是：
$$\bra{\mathbf{r}} \psi^{'}\rangle=\bra{\mathbf{r}-\mathbf{R}} \psi\rangle=\bra{\mathbf{r}} T_{\mathbf{R}}\ket{\psi} $$
这引出一个Hilbert space上的homomorphism $T_{\mathbf{R}}$：

>[!Note] Definition 2.1
>Define the translation operator $T_{\mathbf{R}}$:
>$$\bra{\mathbf{r}-\mathbf{R}} \psi\rangle=\bra{\mathbf{r}} T_{\mathbf{R}}\ket{\psi} ,\ \forall \ket{\psi} $$

假设将系统平移$\mathbf{R}$观察系统位置，等于平移前观察的位置加上$\mathbf{R}$：
$$\bra{\psi} T_{\mathbf{R}}^{\dagger}\mathbf{r}T_{\mathbf{R}}\ket{\psi} =\bra{\psi} \mathbf{r}\ket{\psi} +\mathbf{R}$$
则：
$$T_{\mathbf{R}}^{\dagger}\mathbf{r}T_{\mathbf{R}}=\mathbf{r}+\mathbf{R}$$
我们假设如下的transformation law：

>[!Note] Postulate 2.1
>$$T_{\mathbf{R}}^{\dagger}\mathbf{r}T_{\mathbf{R}}=\mathbf{r}+\mathbf{R}$$

由于translation operator $T_{\mathbf{R}}=\exp\left( - \frac{i}{\hbar}\mathbf{p}\cdot \mathbf{R} \right)$，所以：
$$T_{\mathbf{R}}^{\dagger}\mathbf{p}T_{\mathbf{R}}=\mathbf{p}$$
由于晶体的平移对称性，我们有：

>[!Success] Proposition 2.1
>$$T_{\mathbf{R}}^{\dagger}HT_{\mathbf{R}}=H,\ \forall \mathbf{R}\in \Lambda$$
## Proof.
$$\begin{align}
T_{\mathbf{R}}^{\dagger}HT_{\mathbf{R}} & = T_{\mathbf{R}}^{\dagger}\left( \frac{p^{2}}{2m}+V(\mathbf{r}) \right)T_{\mathbf{R}} \\
 & = \frac{p^{2}}{2m}+ V(\mathbf{r}+\mathbf{R}) \\
 & = \frac{p^{2}}{2m}+V(\mathbf{r})
\end{align}$$
>[!Right]
>$\blacksquare$

这等价于说$[T_{\mathbf{R}},H]=0,\ \forall \mathbf{R}\in \Lambda$。又容易证明$[T_{\mathbf{R}_{1}},T_{\mathbf{R}_{2}}]=0,\ \forall \mathbf{R}_{1},\mathbf{R}_{2}\in \Lambda$。且$H$ hermitian，$T_{\mathbf{R}}$ unitary，本身又都可以被对角化，所以可以找到基矢使得它们全部同时对角化。

设Hamiltonian本身有一套特征矢$\{ \ket{\mathbf{R},n} \}$满足：
$$T_{\mathbf{R}^{'}}\ket{\mathbf{R},n} = \ket{\mathbf{R}+\mathbf{R}^{'},n} $$
称为Wannier态。第一个量子数$\mathbf{R}$表示site，第二个量子数$n$表示这个site的第$n$条轨道。那么
$$\ket{\mathbf{k},n} = \sum_{\mathbf{R}\in \Lambda}e^{i\mathbf{k}\cdot \mathbf{R}}\ket{\mathbf{R},n} $$
就是一套可以同时对角化的基矢。容易证明：
$$T_{\mathbf{R}}\ket{\mathbf{k},n} =e^{-i \mathbf{k} \cdot \mathbf{R}}\ket{\mathbf{k},n} $$
那么可以得到$\ket{\mathbf{k},n}$的本征方程和边界条件：
$$\begin{align}
H\ket{\mathbf{k},n} =E\ket{\mathbf{k},n} ,\ T_{\mathbf{R}}\ket{\mathbf{k},n} =e^{-i\mathbf{k}\cdot \mathbf{R}}\ket{\mathbf{k},n} 
\end{align}$$
注意到边界条件不是一个周期性边界条件。可构造$U(1)$变换使得边界条件为周期性条件。令$\ket{u_{\mathbf{k}}}=e^{-i\mathbf{k}\cdot \mathbf{r}}\ket{\mathbf{k},n}$。那么：
$$\begin{align}
T_{\mathbf{R}}\ket{u_{\mathbf{k}}}  & = T_{\mathbf{R}}e^{-i\mathbf{k}\cdot \mathbf{r}}T_{\mathbf{R}}^{\dagger}T_{\mathbf{R}}\ket{\mathbf{k},n}  \\
 & = T_{-\mathbf{R}}^{\dagger}e^{-i\mathbf{k}\cdot \mathbf{r}}T_{-\mathbf{R}}T_{\mathbf{R}}\ket{\mathbf{k},n}  \\
 & = e^{-i\mathbf{k}\cdot(\mathbf{r}-\mathbf{R})} e^{-i\mathbf{k}\cdot \mathbf{R}}\ket{\mathbf{k},n}  \\
 & = \ket{u_{\mathbf{k}}} 
\end{align}$$
则$\ket{u_{\mathbf{k}}}=e^{-i\mathbf{k}\cdot \mathbf{r}}\ket{\mathbf{k},n}$。则$T_{\mathbf{R}}\ket{u_{\mathbf{k}}}=\ket{u_{\mathbf{k}}}$。当然，$H$在$\ket{u_{\mathbf{k}}}$下不一定对角化。本征方程相应变为：
$$\begin{align}
 & \left( \frac{p^{2}}{2m}+V(\mathbf{r}) \right)\ket{\mathbf{k},n} =E\ket{\mathbf{k},n}  \\
\implies &  e^{-i\mathbf{k}\cdot \mathbf{r}}\left( \frac{p^{2}}{2m}+V(\mathbf{r}) \right)e^{i\mathbf{k}\cdot \mathbf{r}}e^{-i\mathbf{k}\cdot \mathbf{r}} \ket{\mathbf{k},n} =Ee^{-i\mathbf{k}\cdot \mathbf{r}}\ket{\mathbf{k},n}  \\
\implies  &  \left( \frac{|\mathbf{p}+\hbar \mathbf{k}|^{2}}{2m}+V(\mathbf{r}) \right)\ket{u_{\mathbf{k}}} =E\ket{u_{\mathbf{k}}} 
\end{align}$$
记$H(\mathbf{k})=\frac{|\mathbf{p}+\hbar \mathbf{k}|^{2}}{2m}+V(\mathbf{r})$。所以$H(\mathbf{k})$在$\ket{u_{\mathbf{k}}}$下对角化。只需要在一个primitive cell中解变换后的本征方程，并impose periodic boundary condition即可。

注意到：
$$\begin{align}
\ket{\mathbf{k}+\mathbf{G},n}  & = \sum_{\mathbf{R}\in \Lambda}e^{i(\mathbf{k}+\mathbf{G})\cdot \mathbf{R}}\ket{\mathbf{R},n} =\sum e^{i\mathbf{k}\cdot \mathbf{R}}\ket{\mathbf{R},n} =\ket{\mathbf{k},n} 
\end{align} $$
所以可将$\mathbf{k}$限制在FBZ。

设晶体在方向$\mathbf{a}_{i}$上有$N_{i}$个lattice point。由periodic boundary condition：
$$T_{N_{i}\mathbf{a}_{i}}\ket{\mathbf{k},n} =\ket{\mathbf{k},n}\implies e^{-i\mathbf{k}\cdot N_{i}\mathbf{a}_{i}}\ket{\mathbf{k},n} =\ket{\mathbf{k},n}\implies N_{i} \mathbf{k}\cdot \mathbf{a}_{i}=2\pi m   $$
所以$\mathbf{k}$是离散的。
# 3. 时间反演对称性

经典地讲，给定trajectory $(q(t),p(t))$，符合Hamilton方程：
$$\dot{q}(t)= \frac{\partial H(q,p)}{\partial p(t)},\ \dot{p}(t)=- \frac{\partial H(q,p)}{\partial q(t)}$$
那么显然$(q(-t),-p(-t))$也符合方程。因为：
$$\begin{align}
 & \dot{q}(t)=\frac{\partial H}{\partial p(t)}\implies - \frac{\partial q(-t) }{\partial t}= \frac{\partial H}{\partial p(-t)}\implies \frac{\partial q(-t)}{\partial t}= \frac{\partial H}{-\partial p(-t)} \\
 & \dot{p}(t)=- \frac{\partial H}{\partial q(t)}\implies - \frac{\partial p(-t)}{\partial t}=- \frac{\partial H}{\partial q(-t)}
\end{align}$$
这种操作称为时间反演。反演前后轨迹在$t=0$时，$q$开始于同一点，$p$反向。

令$\Theta$为时间反演算符。我们要求