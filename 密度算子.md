# 1. 密度算子

考虑$H$本征态的经典混合。我们想知道在这些量子态的经典混合下，可观测量$f$的平均值为多少。

令取到$\ket{\psi_{i}}$的概率为$p_{i}$。然后取到$\psi_{i}$，又有$|\bra{f}\psi_{i}\rangle|^{2}$的概率得到值$f$。则：
$$\begin{align}
\langle \mathcal{f}\rangle & =\sum_{i,f} p_{i} |\bra{f} \psi_{i}\rangle|^{2}f \\
 & = \sum_{i,f}p_{i} f\bra{\psi_{i}} f\rangle \bra{f} \psi_{i}\rangle \\
 & = \sum_{i}p_{i} \bra{\psi_{i}} f \ket{\psi_{i}}  
\end{align}$$
我们可以再任意基$\{ \ket{j} \}$下展开上式，得到：
$$\begin{align}
\langle f \rangle  & = \sum_{i,j,k}p_{i} \bra{\psi_{i}} j\rangle \bra{j} f \ket{k} \bra{k} \psi_{i}\rangle \\
 & = \sum_{j,k}\left( \sum_{i}p_{i}\bra{k} \psi_{i}\rangle\bra{\psi_{i}} j\rangle \right)\bra{j} f\ket{k} 
\end{align}$$
定义：

>[!Note] Definition 1
>Given a classical mixture of states, with $\ket{\psi_{i}}$ having probability $p_{i}$, define the density operator:
>$$\rho=\sum_{i}p_{i} \ket{\psi_{i}} \bra{\psi_{i}} $$

于是有：
$$\langle f \rangle = \sum_{j,k}\rho_{kj}f_{jk}\tag{*}$$
显然$\rho,f$都是$(1,1)$型张量。$(*)$显然是缩并两次，得到标量。显然$(*)$可以写为：

>[!Note] Proposition 1
$$\langle f \rangle=Tr(\rho \cdot f)$$
## Remark
注意，上面我写$\rho \cdot f$是将$\rho,f$都看成$(1,1)$型张量，然后作一次缩并。有时也可以看到直接写$Tr(\rho f)$。这里就是把$\rho,f$看成正常的算子，然后作算子复合。其实我的notation不太严格。

严格来说，应该有作为矢量空间上算子的$\rho,f$，还有它们对应到的张量同构。容易证到，用这两个张量同构的缩并作用在任意矢量，再同构回去，等于用这两个算子复合作用在同一个矢量，即将两个算子看成张量作缩并等价于两个算子复合。在定义域明确的情况下，我可能会将算子和算子的同构张量符号混用。

其实这是显然的。注意到如下命题

>[!Note] Lemma 1
>Let $A,B$ be operators on $V$. Let $\phi:V\rightarrow V\otimes V^{*}$ be the isomorphism that identifies operators to their corresponding tensors. Then $\phi(AB)=\phi(A)\cdot \phi(B)$.

这其实都不能算是命题，只是isomorphism的定义。然后一切就都显然了。

## Ex: 量子混合和经典混合的区别

考虑一个量子混合$\sum_{i}a_{i}\ket{\psi_{i}}$。则任意可观测量$f$的平均为：
$$\langle f \rangle=\sum_{i,j}a_{i}^{*}a_{j}\bra{\psi_{i}} f\ket{\psi_{j}}  $$
考虑一个经典混合$\ket{\psi_{i}}\text{ with probability }p_{i}$。则任意可观测量$f$的平均为：
$$\begin{align}
\langle f \rangle & =\sum_{i,f}p_{i}f |\bra{\psi_{i}} f\rangle|^{2} \\
 & = \sum_{i,f} p_{i}f\bra{\psi_{i}}f\rangle \bra{f} \psi_{i}\rangle \\
 & = \sum_{i}p_{i}\bra{\psi_{i}} f\ket{\psi_{i}}  
\end{align}$$
即便是取$a_{i}=\sqrt{ p_{i} }$，得到的结果也不一样。经典混合里面没有off-diagonal term的参与。

# 2. 密度矩阵矩阵元的含义

我们可以再任意基$\{ \ket{j} \}$下得到密度矩阵的矩阵元：
$$\rho_{ij}=\bra{i} \rho \ket{j} $$
>[!Note] Proposition 1
>$\rho_{ii}$ represent the probability that the system collapses into state $\ket{i}$
## Proof.
令系统的态为$\ket{\psi_{i}}$的经典混合，取到$\ket{\psi_{i}}$的概率为$p_{i}$。然后，在$\ket{\psi_{i}}$坍缩到$\ket{i}$的概率为$|\bra{i}\psi_{i}\rangle|^{2}$。于是：
$$Prob(\text{collapse into }\ket{i} )=\sum_{j}p_{j}|\bra{i} \psi_{j}\rangle|^{2}=\bra{i} \sum_{j}p_{j}\ket{\psi_{j}} \bra{\psi_{j}} i\rangle=\rho_{ii} $$
>[!Right]
>$\blacksquare$
# 3. 密度算子的时间演化

考虑Schrodinger绘景。发现密度算子$\rho=\sum p_{k}\ket{\psi_{k}}\bra{\psi_{k}}$。其中$\ket{\psi_{k}}$是逆变的，而$\bra{\psi_{k}}$是协变的。这和一个普通的，Schrodinger绘景下不变的算子$A = \sum a\ket{a}\bra{a}$是反着的。因为$\ket{a}$在是协变的，$\bra{a}$是逆变的。

所以密度算子在Schrodinger绘景下会变动，而在Heisenberg绘景下不会变动。

>[!Note] Proposition 1 (von Neumann's equation)
>$$\frac{d}{dt}\rho= \frac{1}{i\hbar}[H,\rho]$$
## Proof.
$$\begin{align}
i\hbar \frac{d}{dt}\rho & = \sum_{k}p_{k}\left[\left( i\hbar \frac{d}{dt}\ket{\psi_{k}}    \right)\bra{\psi_{k}} +\ket{\psi_{k}} \left( i\hbar \frac{d}{dt}\bra{\psi_{k}}  \right)\right] \\
 & = \sum p_{k}(H\ket{\psi_{k}} \bra{\psi_{k}} -\ket{\psi_{k}} \bra{\psi_{k}} H) \\
 & = [H,\rho]
\end{align}$$
>[!Right]
>$\blacksquare$
## Remark
上述命题必须假设$\frac{\partial}{\partial t}p_{k}=0$。

>[!Note] Proposition 2
>$$i\hbar \frac{d}{dt}\langle f \rangle=Tr([H,\rho]f)+ i\hbar \langle \frac{\partial f}{\partial t}\rangle$$
## Proof.
我们有：
$$\begin{align}
i\hbar \frac{d}{dt}\langle f \rangle & = i\hbar \frac{d}{dt}\sum_{i,j}\rho_{ij}f_{ji} \\
 & = \sum \left(  f_{ji}i\hbar \frac{d}{dt}\rho_{ij}+ \rho_{ij} i\hbar \frac{d}{dt}f_{ji}  \right) \\
\end{align}$$
注意到：
$$\begin{align}
\sum_{i,j}f_{ji}i\hbar \frac{d}{dt}\rho_{ij} & = \sum \bra{j} f \ket{i} i\hbar \frac{d}{dt}\bra{i} \rho \ket{j}  \\
 & = \sum \bra{j} f \ket{i} \bra{i} i\hbar \frac{d}{dt}\rho \ket{j}  \\
 & = \sum_{j}\bra{j} f\left( i\hbar \frac{d}{dt}\rho \right)\ket{j} \\
 & = Tr\left( f\left(  i\hbar \frac{d}{dt}\rho \right) \right) \\
 & = Tr(f[H,\rho]) \\
 & = Tr([H,\rho]f) 
\end{align}$$
还有：
$$\begin{align}
\sum_{i,j}\rho_{ij}i\hbar \frac{d}{dt}f_{ji}  & = \sum \bra{i} \rho \ket{j} i\hbar \frac{d}{dt}\bra{j} f\ket{i}  \\
 & = \sum_{i}\bra{i} \rho\left(  i\hbar \frac{d}{dt}f \right)\ket{i} \\
 & = Tr\left( \rho \left( i\hbar \frac{d}{dt}f \right) \right) \\
 & = i\hbar\langle \frac{d}{dt}f\rangle 
\end{align}$$
>[!Right]
>$\blacksquare$

我们考虑量子力学视角下的平衡。什么是平衡？对于任意可观测量$f$，若$\langle f \rangle$不随时间变化，那就叫做平衡。这就必须要求：
$$\frac{d}{dt}\langle f\rangle= \frac{d}{dt} Tr(\rho f)=0,\forall f\text{ observables}$$
容易证明：
$$\frac{d}{dt}Tr(\rho f)=Tr\left(  f\frac{d}{dt}\rho+ \rho \frac{d}{dt}f \right)$$
不妨取$f$为任意不含时间可观测量。则
$$Tr\left(  f\frac{d}{dt}\rho \right)=0$$
因为$f$的任意性，必须要求$\frac{d}{dt}\rho=0$。于是：

>[!Note] Definition 1
>If $\frac{d\rho}{dt}=0$, then the ensemble is called a stationary ensemble. This is when the system is in equilibrium.

^7b6ad6

# 4. 系综的量子化

考虑平衡时系统处在某个状态中。我们没有理由假设这个状态是某个量子态。我们作最general的假设，认为这个状态是一些量子态的经典混合。我们唯一知道是：

- 当系统处在这个状态时，所有可观测量平均值不随时间变动

根据[[密度算子#^7b6ad6|definition 3.1]]，我们必须认为，这个状态对应的密度算子不随时间变动。则$\frac{d\rho}{dt}=0$。那么由von Neumann's equation，我们有：
$$[H,\rho]=0$$
我们选取一套simultaneously diagonalize $H,\rho$的能量本征态来描述系统。

令能量本征态为$\{ \ket{n} \}$。那么此时密度算子可以写成：
$$\rho=\sum_{n}p_{n}\ket{n} \bra{n} $$
也就是说，系统可以看作各个能量本征态的经典混合！

## 4.1 微正则系综

假设系统具有能量$E$。我们必须有如下假设：
- 若$E=E_{n}$为本征能量，那么系统处于对应的状态的概率为$\frac{1}{\Omega}$。
- 若$E\neq E_{n},\forall n$，那么系统除以该状态概率为零。

## 4.2 正则系综

假设系统的状态由$\rho=\sum p_{n}\ket{n}\bra{n}$描述，那么由系综理论，系统具有某个具体能量$E_{j}$的概率是$\propto \exp(-\beta E_{j})$。系统具有某个具体的能量$j$的概率，也就是观测后坍缩到$\ket{j}$的概率。

系统处在态$\ket{l}$的经典概率是$p_{l}$。那么要坍缩到$\ket{j}$，就以$p_{j}$的经典概率取到$\ket{j}$，然后坍缩。其它的态都是垂直的，不可能坍缩到$\ket{j}$。那么我必有：
$$p_{j}\propto \exp(-\beta E_{j})$$
所以：
$$\begin{align}
\rho  & \propto \sum_{n}\exp(-\beta E_{n})\ket{n} \bra{n} \\
 &  =\sum_{n}\exp(-\beta H)\ket{n} \bra{n}  \\
 & = \exp(-\beta H)
\end{align}$$
最后一步用到了relation of completness。因为要求$Tr(\rho)=1$，显然可以引入normalization $Z=Tr(\exp(-\beta H))=\sum_{n}\bra{n}\exp(-\beta H)\ket{n}=\sum_{n}\exp(-\beta E_{n})$
### Caveat
其中，sum是taken over all linearly independent states $\ket{n}$的。

>[!Note] Proposition 1
>For a canonical ensemble, $$Z= \frac{1}{N!}\sum_{\{ k_{j} \}}   \phantom{x}_{B,F}\bra{k_{1},\dots,k_{N}} \exp(-\beta H) \ket{k_{1},\dots, k_{N}}_{B,F} $$

^a34adb

## Proof.
对于fermion或boson，因为$\ket{k_{1},\dots,k_{N}}_{B,F}$与$\ket{k_{\sigma 1},\dots,k_{\sigma N}}_{B,F}$不是线性独立的$\forall \sigma$，我们就只需要加其中一个就行了。正常全部permute就会重复$N!$次，所以直接除以$N!$。
>[!Right]
>$\blacksquare$

## 4.3 巨正则系综

和正则系综一样。

>[!Note] Definition 1
>Given a system with $M$ particles, define the particle number operator $N$, such that if $\ket{\psi}$ is an eigen state of $H$, then $N\ket{\psi}=M\ket{\psi}$.

>[!Note] Proposition 1
>$$N=M \mathbb{1}$$
## Proof.
显然根据定义，固定粒子数系统的所有本征态都是它的本征态，且本征值一样，都是$M$。
>[!Right]
>$\blacksquare$

那么假设系统的状态由$\rho=\sum p_{n}\ket{n}\bra{n}$描述，那么由系综理论，粒子数为$M_{j}$的系统具有某个具体能量$E_{j}$的概率是$\propto \exp(-\beta E_{j}+\alpha M_{j})$。$M_{j}$个粒子系统具有某个具体的能量$j$的概率，也就是观测后坍缩到$\ket{j}$的概率。

系统处在态$\ket{l}$的经典概率是$p_{l}$。那么要坍缩到$\ket{j}$，就以$p_{j}$的经典概率取到$\ket{j}$，然后坍缩。其它的态都是垂直的，不可能坍缩到$\ket{j}$。那么我必有：
$$p_{j}\propto \exp(-\beta E_{j}+\alpha M_{j})$$
所以：
$$\begin{align}
\rho  & \propto \sum_{n}\exp(-\beta E_{n}+\alpha M_{n})\ket{n} \bra{n} \\
 &  =\sum_{n}\exp(-\beta H+\alpha N)\ket{n} \bra{n}  \\
 & = \exp(-\beta H+\alpha N)
\end{align}$$
因为要求$Tr(\rho)=1$，显然可以引入normalization $Z=Tr(\exp(-\beta H+\alpha N))=\sum_{n}\bra{n}\exp(-\beta H+\alpha N)\ket{n}=\sum_{N}\sum_{\text{state }n\text{ of a system with }N\text{ particles}}\exp(-\beta E_{n})$
>[!Note] Proposition 1
>For a grand ensemble, $$Z= \sum_{N=1}^{\infty}\frac{1}{N!}\sum_{\{ k_{j} \}_{1}^{N}}   \phantom{x}_{B,F}\bra{k_{1},\dots,k_{N}} \exp(-\beta H+\alpha N) \ket{k_{1},\dots, k_{N}}_{B,F} $$

## Proof.
由[[密度算子#^a34adb|proposition 4.2.1]]就是显然。
>[!Right]
>$\blacksquare$







