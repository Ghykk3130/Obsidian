# 1. 将热力学量表达为热力学势的自然导数

我们知道$dU=TdS-pdV \implies U=U(S,V)$。我们选定$S,V$两个独立变量作为natural variable。我们有下面定理：

>[! Theorem 1]
>Any state quantities, or derivative of the state quantities, can be expressed by the derivative of $U$ with respect to $S,V$ only.
## Ex: $\left(  \frac{\partial U}{\partial V} \right)_{T}$
因为我们选定了$S,V$作为natural variables。所以我们有$U=U(S,V),V=V(S,V),T=T(S,V)$。于是：
$$\begin{align}
 & dU= \left( \frac{\partial U}{\partial V} \right)_{S}dV + \left(  \frac{\partial U}{\partial S} \right)_{V}dS \\
 &  dV= \left(  \frac{\partial V}{\partial V} \right)_{S}dV+ \left(  \frac{\partial V}{\partial S} \right)_{V}dS=dV
\end{align}$$
其中，$\left( \frac{\partial V}{\partial S} \right)_{V}=0$是因为我们已经选取了$S,V$作为相互独立的变量了。我们想要计算：
$$ \left(  \frac{\partial U}{\partial V} \right)_{T}= \left(  \frac{\left(  \frac{\partial U}{\partial V} \right)_{S}dV + \left(  \frac{\partial U}{\partial S} \right)_{V}dS }{dV} \right)_{T} \dots*)$$
如果接下来知道$dV$与$dS$的关系，那么分子分母一约分就结束了。而维持$T$为常量正是给出了这样一个约束。我们有：
$$dT= \left(  \frac{\partial T}{\partial S} \right)_{V}dS+ \left(  \frac{\partial T}{\partial V} \right)_{S}dV=0$$
我们想进一步将这个式子里所有的导数都写为$U$对$S,V$的导数。显然我们有：
$$\begin{align}
 &  \left( \frac{\partial T}{\partial S} \right)_{V}= \left(  \frac{\partial}{\partial S} \right)_{V} \left(  \frac{\partial U}{\partial S} \right)_{V}=U_{SS} \\
 &  \left(  \frac{\partial T}{\partial V} \right)_{S}= \left(  \frac{\partial}{\partial V} \right)_{S} \left(  \frac{\partial U}{\partial S} \right)_{V}=U_{VS}
\end{align}$$
于是约束为：
$$U_{SS}dS+U_{VS}dV=0$$
于是在$*)$中将$dS$用$dV$表出，从而得到：
$$ \left(  \frac{\partial U}{\partial V} \right)_{T}= U_{V}+ U_{S}\left( - \frac{U_{VS}}{U_{SS}} \right)$$

# 两条求导规则的说明

>[! Proposition 1]
>$$\left( \frac{\partial A}{\partial B} \right)_{C}=- \frac{(\partial C / \partial B)_{A}}{(\partial C / \partial A)_{B}}$$
## Proof.
我们必须假设，两个状态量确立一个热力学系统。于是系统只有两个独立变量。$\left( \frac{\partial A}{\partial B} \right)_{C}$可以解读为，在$C(A,B)=\text{const.}$的约束下，$dA,dB$也被约束，从而存在一个微分关系。我们有：
$$dC= \left( \frac{\partial C}{\partial A} \right)_{B}dA+ \left(  \frac{\partial C}{\partial B} \right)_{A}dB=0$$
rearrange一下即可证明。
>[!Right]
>$\blacksquare$

>[!Proposition 2]
>$$\left( \frac{\partial A}{\partial B} \right)_{C}=\left( \frac{\partial A}{\partial D} \right)_{C}\left( \frac{\partial D}{\partial B} \right)_{C}$$
## Proof.
$\left( \frac{\partial A}{\partial B} \right)_{C}$解读为，设$A=A(B,C)$，然后对$B$微分。我们为了引入$D$，不妨设$A=A(D,C)$。而$D=D(B,C)$。进而：
$$\begin{align}
\left( \frac{\partial A}{\partial B} \right)_{C} & =\left( \frac{\partial A}{\partial D} \right)_{C}\left( \frac{\partial D}{\partial B} \right)_{C}+ \left( \frac{\partial A}{\partial C} \right)_{D}\left( \frac{\partial C}{\partial B} \right)_{C} \\
 & =\left( \frac{\partial A}{\partial D} \right)_{C}\left( \frac{\partial D}{\partial B} \right)_{C}
\end{align}$$
>[!Right]
>$\blacksquare$
# 2. 将热力学量表达为$C_{p},\alpha,\kappa_{T}$

注意到，Gibbs自由能的三种二阶导对应着三个方便测量的量。即：
$$\begin{align}
 & dG=-SdT+Vdp \\
\implies &  \frac{\partial^{2}G}{\partial T^{2}} =- \left(\frac{\partial S}{\partial T}\right)_{p} =- \frac{C_{p}}{T} \\
 & \frac{\partial^{2}G}{\partial T\partial p}= \left( \frac{\partial V}{\partial T} \right)_{p} = V\beta_{p} \text{ or written as }V\alpha \text{ in other conventions}\\
 &  \frac{\partial^{2}G}{\partial p^{2}}= \left(  \frac{\partial V}{\partial p} \right)_{T}=- V\kappa_{T}
\end{align} \dots *)$$
因为Gibbs自由能的两个一阶导可以表示所有的热力学量，因而三个二阶导也可以表示所有的热力学量。这是因为任意取两个二阶导积分可以得到两个一阶导。剩下的一个二阶导用来确定积分常数。

那么$C_{p},\beta_{p},\kappa_{T}$及其导数一定可以表示所有的热力学量。理论上来说，可以将一切热力学量表达为Gibbs自由能对其natural variable的导数，然后再用上式带回去。
## Ex:
我们想表达$C_{V}$。我们先把它弄成Gibbs自由能的导数。方法见上一节：
$$\begin{align}
C_{V} & = T \left(  \frac{\partial S}{\partial T} \right)_{V}=-TG_{TT}+ T\frac{G_{Tp}^{2}}{G_{pp}}
\end{align}$$
然后由$*)$可知：
$$C_{V}= C_{P}- \frac{TV\beta_{p}^{2}}{\kappa_{T}}$$

但是这样太麻烦了。我们还有另一套流程：
- 若导数中存在热力学势，将热力学势挪到分子，并用热力学势的微分消掉。热力学势的微分指诸如$dU=TdS-pdV$的关系。
- 接下来如果存在化学势，将化学势挪到分子，并用Gibbs-Duhem relation消掉。Gibbs-Duhem relation为$d\mu=-SdT+Vdp$
- 接下来若存在熵，将熵通过Maxwell relations消掉。如果消不掉就用chain rule引入一个$T$再消。
- 接下来将体积移到分子，带入$C_{p},\beta_{p},\kappa_{T}$。如果出现$C_{V}$，用$C_{p}-C_{V}= \frac{TV\beta_{p}^{2}}{\kappa_{T}}$消掉。
 