# 1. 刚体转动

在刚体转动中，fix time，任何一个矢量实体都是不变的。但是刚体转动需要假设矢量实体本身在随着时间变化。
 
我们定义基矢的变换为协变。则：

>[!Proposition 1]
>The position vector is contravariant.
## Proof.

假设基矢的变换为：
$$e^{'}_{i}=R_{ij}e_{j}$$
$$\begin{align}
\implies  & r_{i}^{'}e_{i}^{'}  =r_{i}^{'}R_{ij}e_{j}=r_{j}e_{j} \\
\implies  & r_{j}=r_{i}^{'}R_{ij} \\
\implies & r_{i}^{'}=R_{ij}r_{j}
\end{align}$$
注意，变换矩阵涉及逆矩阵的分量称为逆变分量。这里我其实应该写成$r^{'}_{i}=(R^{-1})_{ji}r_{j}$
>[!Right]
>$\blacksquare$

由朴素的几何直觉可以知道，考虑在经过时间$dt$后，基矢量的变化可以有如下描述：
$$\delta e_{i}=d\alpha \hat{n}\times e_{i}$$
其中$\hat{n}$为一矢量实体。将两边除以$dt$就可以得到：
$$\frac{de_{i}}{dt}= \frac{d\alpha}{dt}\hat{n}\times e_{i}$$
于是可以作如下定义：

>[!Definition 1]
>Define the angular velocity vector: $\vec{\omega}= \frac{d\alpha}{dt}\hat{n}$.

于是，对于刚体系中任何矢量，我们有如下命题：

>[! Proposition 2]
>For any vector $\vec{r}=r_{i}e_{i}$ in the body frame with basis $e_{1},e_{2},e_{3}$, we have:
>$$ \frac{d\vec{r}}{dt}= \frac{dr_{i}}{dt}e_{i}+ \vec{\omega}\times \vec{r}$$
## Proof.
$$\begin{align}
\frac{d\vec{r}}{dt} & = \frac{d}{dt}(r_{i}e_{i}) \\
 & =\frac{dr_{i}}{dt}e_{i}+r_{i} \frac{de_{i}}{dt} \\
 & = \frac{dr_{i}}{dt}e_{i}+r_{i}\vec{\omega}\times e_{i}
\end{align}$$
>[!Right]
>$\blacksquare$
# 2. 转动系中的观测

对于任意一个矢量$\vec{r}(t)$，我们可以再任何基$e_{1},e_{2},e_{3}$下观察它。我们还可以再任何基$e_{1},e_{2},e_{3}$下观察$\vec{r}$随时间的变动。

我们在先基$e_{1},e_{2},e_{3}$观察$\vec{r}$，则$i$方向看到的变化由下式描述：
$$\frac{d}{dt}(\vec{r}\cdot e_{i})$$
## Caveat
注意，这绝不是$\frac{d\vec{r}}{dt}\cdot e_{i}$。我们作如下区分：
- $\frac{d}{dt}(\vec{r}\cdot e_{i})$指的是，先在$e_{i}$下看$\vec{r}$，然后再让$\vec{r}$动。
- $\frac{d\vec{r}}{dt}\cdot e_{i}$指的是，先让$\vec{r}$动，然后再在$e_{i}$下看这个动。

后者实际上是对于一个全新矢量$\frac{d\vec{r}}{dt}$的观察，并不是观察原矢量$\vec{r}$的变化。在任意一个系观察刚体，经过朴素的直觉可以知道，观察到的刚体中某固定点的所有运动都是由前者描述的。我们是无法观测后者的。

这就导致，我们在某系中观察矢量$\vec{r}$的时间演化，实际上观察到的是矢量$\frac{d}{dt}(\vec{r}\cdot e_{i})e_{i}$。一般来说，这和矢量$\vec{r}$的演化不是一个矢量。即：
$$\frac{d\vec{r}}{dt} \neq \frac{d}{dt}(\vec{r}\cdot e_{i})e_{i}$$
# 3. 从角动量引出惯量张量

我们可以定义角动量：
$$\vec{L}=\int d^{3}r\rho \vec{r}\times  \frac{d\vec{r}}{dt}$$
显然，$\vec{L}$为一psudo 1-tensor。

我们知道$\vec{\omega}$定义为$\vec{\omega}\text{ such that } \frac{d\vec{r}}{dt}=\vec{\omega}\times \vec{r}$

于是我们自然想到，$\vec{L}$能否用$\vec{\omega}$表达？这十分简单：
$$\begin{align}
\vec{L} & =\int d^{3}r\rho \vec{r}\times \frac{d\vec{r}}{dt} \\
 & =\int d^{3}r\rho \vec{r}\times(\vec{\omega}\times \vec{r}) \\
 & =\int d^{3}r\rho(r^{2}\vec{\omega}-(\vec{r}\cdot \vec{\omega})\vec{r}) \\
 & =\int d^{3}r\rho(r^{2}I-\vec{r}\vec{r})\cdot \vec{\omega} 
\end{align}$$
由[[张量分析#^dfdd98|quotient law]]可知，$\int d^{3}r\rho(r^{2}I-\vec{r} \vec{r})$为一2-tensor。于是我们定义：

>[!Definition 1]
>Define the inertia tensor as: $\overset{\leftrightarrow}{I}=\int d^{3}r\rho(r^{2}I-\vec{r}\vec{r})$

于是在任何系$e_{1},e_{2},e_{3}$中，我们有：
$$\begin{align}
L_{i} & =\vec{L}\cdot e_{i}  \\
  & =\left( \int d^{3}r\rho(r^{2}I-\vec{r}\vec{r}) \cdot \vec{\omega} \right)\cdot e_{i} \\
 & =\left( \int d^{3}r\rho(r^{2}e_{j}e_{j}-\vec{r}\vec{r})\cdot \vec{\omega} \right)\cdot e_{i} \\
 & =\int d^{3}r\rho(r^{2}e_{j}\omega_{j}-\vec{r}r_{j}\omega_{j})\cdot e_{i} \\
 & =\int d^{3}r\rho(\delta_{ij}r^{2}\omega_{j}-r_{i}r_{j}\omega_{j}) \\
 & =\int d^{3}r\rho(\delta_{ij}r^{2}-r_{j}r_{j})\omega_{j} \\
 & =I_{ij}\omega_{j}
\end{align}$$
为了使得$\int d^{3}r\rho(\delta_{ij}r^{2}-r_{i}r_{j})$是一个常数，我们选择$e_{1},e_{2},e_{3}$为刚体系的基。这也就是说，我们知晓矢量实体$\vec{\omega}$后，我们先计算$w_{j}=\vec{\omega}\cdot e_{j}$，然后再刚体系中计算矩阵乘法$I_{ij}\omega_{j}$以得到$L_{i}$。最后我们计算$L_{i}e_{i}$得到矢量实体$\vec{L}$.

# 4. 从动能引出惯量张量

考虑一个定点转动的刚体的动能：
$$\begin{align}
T & =\int d^{3}r \frac{1}{2}\rho|\dot{\vec{r}}|^{2} \\
 \end{align}$$
 我们知道：
 $$\begin{align}
\dot{\vec{r}} & =  r_{i}\vec{\omega}\times e_{i}   \\

   & =  r_{i}\omega_{j}e_{j}\times e_{i} \\
 & =  r_{i}\omega_{j}\epsilon_{ijk}e_{k}

\end{align}$$
因此：
$$\begin{align}
|\dot{\vec{r}}|^{2} & = (r_{i}\omega_{j}\epsilon_{ijk}e_{k}) \cdot(r_{l}\omega_{m}\epsilon_{lmn}e_{n}) \\
 & =  r_{i}r_{l} \omega_{j}\omega_{m}\epsilon_{ijk}\epsilon_{lmn}\delta_{kn} \\
 & =  r_{i}r_{l}\omega_{j}\omega_{m}\epsilon_{ijk}\epsilon_{lmk} \\
 & = r_{i}r_{l}\omega_{j}\omega_{m}(\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}) \\
 & = r_{i}r_{l}\omega^{2}\delta_{il}-r_{i}r_{l}\omega_{l}\omega_{i} \\
 & = r^{2}\omega^{2}-r_{i}r_{l}\omega_{i}\omega_{l} \\
 & = r^{2}\delta_{il}\omega_{i}\omega_{l}-r_{i}r_{l}\omega_{i}\omega_{l} \\
 & = (r^{2}\delta_{il}-r_{i}r_{l})\omega_{i}\omega_{l}
\end{align}$$
所以若定义惯量张量$\overset{\leftrightarrow}{I}=\int d^{3}r  (r^{2}\delta_{ij}-r_{i}r_{j})e_{i}e_{j}$，动能显然可以写为：
$$T= \frac{1}{2} \vec{\omega} \cdot \overset{\leftrightarrow}{I}\cdot \vec{\omega}$$
>[!Note] Proposition 1
>The kinetic energy of a rigid body is $T= \frac{1}{2} \vec{\omega} \cdot \overset{\leftrightarrow}{I}\cdot \vec{\omega}$

# 5. 用Euler angle表示角速度

考虑如下Euler angle convention:
- 先绕$z$轴逆时针转动$\phi$
- 再绕$x^{'}$逆时针转动$\theta$
- 再绕$z^{''}$逆时针转动$\psi$

我们想知道，这些欧拉角各自变动导致的角速度是多少。
## 5.1 方法一

考虑空间系为$e_{1},e_{2},e_{3}$。设刚体系$e_{1}^{'''},e_{2}^{'''},e_{3}^{'''}$已经转动到了欧拉角$(\phi,\theta,\psi)$的位置。则显然每个欧拉转动各自引出基变换为：
$$\begin{align}
\begin{pmatrix}
e_{1}^{'} & e_{2}^{'} & e_{3}^{'}  
\end{pmatrix} &  = \begin{pmatrix}
e_{1} & e_{2} & e_{3} 
\end{pmatrix}\begin{pmatrix}
\cos \phi &-\sin \phi & 0 \\
\sin \phi & \cos \phi & 0 \\
0 & 0 & 1 
\end{pmatrix} \\
\begin{pmatrix}
e_{1}^{''} & e_{2}^{''} & e_{3}^{''} 
\end{pmatrix} & =\begin{pmatrix}
e_{1}^{'} & e_{2}^{'} & e_{3}^{'}
\end{pmatrix}\begin{pmatrix}
1 & 0 & 0 \\
0 & \cos \theta & -\sin \theta \\
0 & \sin \theta & \cos \theta
\end{pmatrix} \\
\begin{pmatrix}
e_{1}^{'''} & e_{2}^{'''} & e_{3}^{'''}
\end{pmatrix} & = \begin{pmatrix}
e_{1}^{''} & e_{2}^{''} & e_{3}^{''}
\end{pmatrix}\begin{pmatrix}
\cos \psi & -\sin \psi & 0 \\
\sin \psi & \cos \psi & 0 \\
0  & 0 & 1
\end{pmatrix}
\end{align}$$
容易得到：
$$\begin{align}
\begin{pmatrix}
e_{1}^{'''} & e_{2}^{'''} & e_{3}^{'''}
\end{pmatrix} & =\begin{pmatrix}
e_{1} & e_{2} & e_{3}
\end{pmatrix}\begin{pmatrix}
\cos \phi \cos \psi-\cos \theta \sin \phi \sin \psi & -\cos \theta \cos \psi \sin \phi-\cos \phi \sin \psi & \sin \theta \sin \phi \\
\cos \psi \sin \phi+\cos \theta \cos \phi \sin \psi & \cos \theta \cos \phi \cos \psi-\sin \phi & -\cos \phi \sin \theta \\
\sin \theta \sin \psi & \cos \psi \sin \theta  & \cos \theta
\end{pmatrix} \\
 & =\begin{pmatrix}
e_{1} & e_{2} & e_{3}
\end{pmatrix}R(\phi,\theta,\psi)
\end{align}$$

我们设这些角各自进行无穷小变动，进而再引出一个基变换：
$$\begin{align}
\begin{pmatrix}
e_{1}^{''''} & e_{2}^{''''} & e_{3}^{''''}
\end{pmatrix}  & = \begin{pmatrix}
e_{1} & e_{2} & e_{3}
\end{pmatrix}\left( R(\phi,\theta,\psi)+ \frac{\partial R}{\partial \phi}d\phi+\frac{\partial R}{\partial \theta}d\theta+\frac{\partial R}{\partial \psi}d\psi \right)
\end{align}$$
令$de_{i}^{'''}=e_{i}^{''''}-e_{i}^{'''}$。我们知道，角动量应当描述从$e_{1}^{'''},e_{2}^{'''},e_{3}^{'''}$到$e_{1}^{''''},e_{2}^{''''},e_{3}^{''''}$的无穷小变换。设角度矢量为$\vec{\alpha}$，则得到如下方程组：
$$\begin{align}
de_{i}^{'''}=\vec{\alpha}\times e_{i}^{'''}
\end{align}$$
拆成分量后经过一番爆算，可以得到在刚体系$e_{1}^{'''},e_{2}^{'''},e_{3}^{'''}$下：
$$\begin{align}
\vec{\alpha}=(d\phi \sin \theta \sin \psi+d\theta \cos \psi)e_{1}^{'''}+(d\phi \sin \theta \cos \psi-d\theta \sin \psi)e_{2}^{'''}+(d\phi \cos \theta+d\psi)e_{3}^{'''}
\end{align}$$
将其除以$dt$得到刚体系中由欧拉角表示的角速度：

>[!Note] Proposition 1
The angular velocity of rotation represented by Euler angles in the body frame is:
>$$\begin{align}
\omega_{1} & =\dot{\phi}\sin \theta \sin \psi+\dot{\theta}\cos \psi \\
\omega_{2} & =\dot{\phi}\sin \theta \cos \psi- \dot{\theta}\sin \psi \\
\omega_{3} & =\dot{\phi}\cos \theta+\dot{\psi}
\end{align}$$

因为实在是太难算了，下面是计算$de_{i}$的code:
```mathematica
A1[\[Phi]_] := {{Cos[\[Phi]], -Sin[\[Phi]], 0},{Sin[\[Phi]], Cos[\[Phi]], 0},{0,0,1}};

A2[\[Theta]_] = {{1,0,0},{0,Cos[\[Theta]], -Sin[\[Theta]]}, {0,Sin[\[Theta]], Cos[\[Theta]]}};

A3[\[Psi]_] = {{Cos[\[Psi]], -Sin[\[Psi]], 0},{Sin[\[Psi]], Cos[\[Psi]], 0},{0,0,1}};

x = A1[\[Phi]] . A2[\[Theta]] . A3[\[Psi]];
Dev = Dt[x];
{{e1},{e2},{e3}} = LinearSolve[Transpose[x],{{e1p},{e2p},{e3p}}];
{{e1pp,e2pp,e3pp}} = {{e1,e2,e3}} . (x+Dev);
de = {{e1pp},{e2pp},{e3pp}}-{{e1p},{e2p},{e3p}} // Simplify;
```

## 5.2 方法二

一个更简单的方法是，注意到角速度矢量由三个欧拉角的角速度矢量相加而成。即：
$$\vec{\omega}= \vec{\omega}_{\phi}+\vec{\omega}_{\theta}+\vec{\omega}_{\psi}$$
而显然：
$$\begin{align}
 & \vec{\omega}_{\phi}=\dot{\phi}e_{3}^{'} \\
 & \vec{\omega}_{\theta}=\dot{ \theta}\cos \psi e_{1}^{'''}-\sin \psi  \dot{ \theta}e_{2}^{'''} \\
 & \vec{\omega}_{\psi}= \dot{\psi}e_{3}^{'''}
\end{align}$$
而只要将所有基矢量表达为刚体系基矢$e_{1}^{'''},e_{2}^{'''},e_{3}^{'''}$即可。显然：
$$\begin{align} &  \vec{\omega}_{\phi}= \dot{\phi}\cos \theta e_{3}^{'''}+  \dot{\phi}\sin \theta \sin \psi e_{1}^{'''}+\sin \theta \cos \psi e_{2}^{'''} \\
 & \vec{\omega_{\theta}}=\dot{ \theta}\cos \psi e_{1}^{'''}-\sin \psi  \dot{ \theta}e_{2}^{'''} \\
 & \vec{\omega}_{\psi}=\dot{\psi}e_{3}^{'''}
\end{align}$$
整理后可以得到同样的结果：
$$\begin{align}
\omega_{1} & =\dot{\phi}\sin \theta \sin \psi+\dot{\theta}\cos \psi \\
\omega_{2} & =\dot{\phi}\sin \theta \cos \psi- \dot{\theta}\sin \psi \\
\omega_{3} & =\dot{\phi}\cos \theta+\dot{\psi}
\end{align}$$

# 6. 刚体动能

在4.中，我们已经推知刚体动能为$T = \frac{1}{2} \vec{\omega}\cdot \overset{\leftrightarrow}{I} \cdot \vec{\omega}$。但是惯量张量$I$的表示在除了刚体系之外的系都在不停地变动。

但是我们已经将角速度表达在了刚体系之中。而在刚体系中惯量张量的表示也是定值。于是计算$T$是方便的。

更进一步地讲，如果在刚体系中惯量张量表示已经对角化，即$I = diag(I_{1},I_{2},I_{3})$，并且刚体具有对称性$I_{1}=I_{2}$, 那么：

>[!Note] Proposition 1
>Let $(\phi,\theta,\psi)$ be Euler angles. Assume that the representation of $\overset{\leftrightarrow}{I}$ is $diag(I_{1},I_{1},I_{3})$ in the body frame. Then the kinetic energy is given by:
>$$T = \frac{1}{2}I_{1}(\dot{\phi}^{2}\sin ^{2}\theta+ \dot{\theta}^{2})+ \frac{1}{2}I_{3}(\dot{\phi}^{}\cos ^{}\theta+  \dot{\psi}^{})^{2}$$

