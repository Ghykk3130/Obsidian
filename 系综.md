# 1. Ergodic hypothesis

统计力学的基本问题：我们观察系统得到一个宏观量。这个宏观量到底和微观量是怎么联系起来的？

我们来看经典力学如何回答这个问题。考虑一个有$N$自由度的系统。则可以选择$N$个广义坐标与$N$个广义速度描述这个系统。系统的演化可以被相空间中由一条被$t$ parmetrize的曲线描述。我们认为，观察系统得到的宏观量对应于某个微观量$f(q,p)$。我们必须假设一次观测经过了很长时间，以至于得到的宏观量是该微观量的平均。即：

$$\bar{f}= \lim_{ T \to \infty } \frac{1}{T}\int_{0}^{T}dtf(q(t),p(t)) $$

在统计力学中，我们考虑给定约束下系统可能到达的态，将这些态构成的集合称为$\Sigma$。我们定义相空间上的测度$\mu$。那么，我们可以求相空间上$f(q,p)$的平均：
$$\langle f\rangle= \int_{\Sigma}d\mu(q,p) f(q,p) $$
我们求完Radon-Nikodym导数之后可以全部写为Lebesgue测度的积分：
$$\langle f\rangle=\int_{\Sigma}dqdp\rho(q,p)f(q,p)$$





我们给每个态$(q,p)$ assign一个系统出现在该态的概率密度$\rho(q,p)$。


这是经典力学的picture。在统计力学中，我们仍然认为相空间中存在这样一条曲线。不过由于系统过于复杂，解出Hamilton方程是困难且不practical的。所以对于这样一个系统，我们不在意系统是何时经过某点的（经典力学的picture），而是在意在随机时刻观察，系统经过该点的可能性。换句话说，我们用相空间体积内发现系统的概率来描述系统。

系统的microstate由其中每个粒子，或者说每个广义坐标共同确定。一个microstate就是相空间中的一个相点。我们依据系统经过这些microstate的“次数”的多少，构建出概率：

我们想象大量这个系统的copy。在零时刻时，在系统出现次数多的地方，放上更多copy。在系统出现次数少的地方，放上更少的copy。这些copy的密度就定义为$\rho(q,p)$。所有的这些copy构成的集合称为系综。或者更正式地：

>[!Definition 1]
>Define the probability measure $w$, which measures the probability that the system is in some volume in the phase space, if we observe at a random instance.

我们可以由这个概率测度引出概率密度。

>[!Definition 2]
>Define the distribution function $\rho$ of the (sub)system as the Radon-Nikodym derivative of $w$. Formally: $dw=\rho dqdp$
## Remark
此处只是简写。实际上应当写为：$dw=\rho d^{3N}qd^{3N}p$。


接下来我们试图在$2N$维的相空间中将系统的演化抽象地描绘成一个流体力学系统。我们将系统“流体化”的想法是：

>[! Postulate 1 (ergodic hypothesis)]
>After long enough time, the system would pass through all possible microstates.
## Remark
这当然是一个错误的假设。因为系统轨迹只是一个Hamilton方程的解。如果该轨迹经过所有的点，那么必然会和一些初始条件不同的解相交，违反解的唯一性。再者，要系统轨迹经过所有的点，我们需要将一条一维曲线映射成更高维的hypersurface。这显然是不可能的。

>[! Idea 1]
系综的基本想法是，对于任何一个microstate的态函数$f(q,p)$，一个系统在$0\sim \infty$的时间平均就等于在$0$时刻对整个系综平均。即：
$$\langle f \rangle =  \lim_{ T \to \infty }\frac{1}{T}\int_{0}^Tdtf(q(t),p(t))= \left.\frac{\int dqdpf(q,p)\rho(q,p)}{\int dqdp\rho(q,p)} \right|_{t=0}\dots*)$$
## Remark
统计力学中，我们关心的问题就是一个microstate的态函数在（一个系统上）长时间观察后的平均。而系综就是在回答这个问题。系综将一个系统在无限长时间上的平均替换成了在相空间中的平均。

而显然，postulate 1如果被满足，idea 1也就被满足了。

当然，就算系统不经过所有的microstate也可以得到$*)$。只要系统大概能经过所有microstate，上述关系也能成立。为了修复postulate 1的错误，我们作如下假设：

>[!Postulate 2 (quasi ergodic hypothesis)]
>After long enough time, the trajectory of the system would meet all possible microstates $w$-almost everywhere.

# 2. Liouville's theorem

我们刚刚的推导与假设仅适用于处于平衡中的系统。因为系统处于平衡，所以我们可以认为系统划出的轨迹是“稳定的，有规律的”。系统出现在相空间中某处的概率是不随时间变化的。因为平衡态已经假设系统经历了比豫驰时间长得多的时间，所以我在此刻观察和在一万年之后观察看到的$\rho$是一样的。

但是，也有可能系统不处于平衡态。那么我此刻构建出的系综中相点的分布和下一刻构建出的系综中相点的分布是不一样的。于是：
$$\frac{\partial \rho}{\partial t}\neq{0}$$

那么，此时系综中相点的分布有怎样的规律呢？我们作如下命题。

>[! Theorem 1 (Liouville's theorem)]
>The material derivative $\frac{D\rho}{Dt}= \frac{d\rho}{dt}=\{\rho,H\}+ \frac{\partial \rho}{\partial t}=0$
## Proof.
$$\begin{align}
\frac{D\rho}{Dt} & =\frac{\partial \rho}{\partial q_{i}}  \dot{q_{i}}+ \frac{\partial \rho}{\partial p_{i}}  \dot{p_{i}}+ \frac{\partial \rho}{\partial t}
\end{align}$$
我们发现这长得很像连续性方程，即：
$$ \frac{\partial \rho}{\partial t}+\nabla \cdot(\rho \vec{v})=0 $$
这里之所以可以用连续性方程，是因为相点总数是守恒的。没有相点凭空出现或者消失。
我们展开就有：
$$\begin{align}
\frac{\partial \rho}{\partial t}+ \nabla \cdot(\rho \vec{v}) & =\frac{\partial \rho}{\partial t}+\vec{v}\cdot \nabla \rho + \rho \nabla \cdot \vec{v} \\
 & =\frac{\partial \rho}{\partial t}+\vec{v}\cdot \nabla \rho + \rho \left( \frac{  \partial \dot{ q_{i}}}{\partial q_{i}}+ \frac{\partial  \dot{p_{i}} }{\partial p_{i}} \right) \\
 & =\frac{\partial \rho}{\partial t}+\vec{v}\cdot \nabla \rho + \rho\left( \frac{\partial^{2}H}{\partial q_{i}\partial p_{i}}- \frac{\partial^{2}H}{\partial p_{i}\partial q_{i}} \right) \\
 & =\frac{\partial \rho}{\partial t}+\vec{v}\cdot \nabla \rho \\
 & = \frac{\partial \rho}{\partial t}+ \frac{\partial \rho}{\partial q_{i}}  \dot{q_{i}}+ \frac{\partial \rho}{\partial p_{i}}  \dot{p_{i}}=0
\end{align}$$
>[!Right]
>$\blacksquare$
## Remark
1. 这也就是说，相点密度的随体导数为$0$。这也就是说，如果我们随着系统移动，我们看到的相点密度不会变化。也就是说这个相点体积邻域里面相点数目没有变化。这也就是说任何相点邻域内相点的运动都和这个相点一样，就像影流之主一样。没有任何相点因为太快或太慢而跑出这个邻域。或者说，固定数量的相点因为运动都一样，只占据固定的体积。但这仅限于某个系统。
2. 其实正常的逻辑应该是用Liouville定理解非平衡态的$\rho$。假设同样由于系统过于复杂，系统的初始状态有一定不确定性。那么我们给出一个初始分布。显然之后某个时间点的分布就是由初始状态的这个系综中相点直接按照力学演化而来的。这等价于Liouville定理。所以我们只需要给定初始状态，解$\{\rho,H\}+ \frac{\partial \rho}{\partial t}=0$即可获得任意时刻的相点分布。

# 3. State quantities

最普遍地，一个系统在相空间中的运动是任意的。它可以到达相空间$\mathbb{R}^{6N}$中的任何一个点。

这个系统的运动，即microstate，由Hamiltonian完全确定。我们可以给这个系统associate一些microstate的函数。例如能量（由[[守恒律#^7e6526|守恒律definition 3.1]]）：
$$\begin{align}
E & = \frac{\partial L}{\partial  \dot{q_{i}}}  \dot{q_{i}}-L \\
 & =\frac{\partial}{\partial  \dot{q_{i}}}(p_{i}  \dot{q_{i}}-H)  \dot{q_{i}}-(p_{i}  \dot{q_{i}}-H) \\
 & =H
\end{align}$$
例如体积：
将Hamiltonian中的势能项找到，若是一个无限深势阱，将势阱的大小提出来作为体积。要specify一个microstate的运动，就需要specify势阱。反过来，microstate的运动specify了，势阱也就明确了。于是体积是microstate的函数。

例如压强：
压强原则上可以由系统内粒子运动来计算，而粒子运动又完全是Hamiltonian决定的。所以原则上来讲可以将压强写为正则坐标的函数。

例如粒子数：
原则上来讲和自由度有关。只要specify了microstate的运动，自由度也就立即明确了。显然是microstate的函数。

如果我们给这些函数在平衡态下的平均值一些约束，例如说对于封闭系统，我们有$\langle E\rangle=E=\text{constant}$。那么系统在相空间中的运动就相应地被约束在一个范围内。而相应地，对于相对应与某种约束，仍然有大量可能的microstate与之对应。所有的这些microstate都满足相同的约束（例如$\langle E\rangle=\text{constant}$）。于是我们将$E,V,P,N,..$这些函数的平均值称之为macroscopic quantity，或者state quantity。而所有由某个对平均值的约束确定的microstate的集合称为一个macrostate。我们总结为下面这个idea：

>[!Idea 1]
>考虑有某个microstate的函数$f$。我们把平衡态下该函数平均值$\langle f\rangle$相同的microstate group到一起，称为一个macrostate。相应地，一个macrostate对应大量的microstate。

>[! Proposition 1]
>If a system is in equilibrium, then any state quantity is independent of time.
## Proof.
显然，对于处于平衡态的系统，我们有：
$$\frac{\partial \rho}{\partial t}=0$$
令$f(q,p)$为任意microstate的函数。则相应地state quantity为：
$$\langle f \rangle=\frac{\int dqdpf\rho}{\int dqdp\rho}$$
因为右手边不含时间，所以左手边也不含时间。
>[!Right]
>$\blacksquare$
## Caveat
需要注意，逆命题是不正确的。我们不能说：

**若存在一个state quanity独立于时间，则系统处于平衡态**

例如考虑一个isolated system，则state quantity $E$在任何时候都是独立于时间的。但是显然不能下结论说系统处于平衡态。


