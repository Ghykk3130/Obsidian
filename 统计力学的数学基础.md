# 1. Liouville定理

>[!Definition]
>Given a Hamiltonian system, define the phase flow $g^{t,t_{0}}$ as:
>$$g^{(t_{},t_{0})}:(q(t_{0})),p(t_{0})\rightarrow(q(t),p(t))$$
>where $(q(0),p(0))$ is an arbitrary point in the phase space, $(q(t),p(t))$ is the solution of the Hamilton's equation starting from $(q(t_{0}),p(0))$ at time $t$.
## Remark
我们必须理解当作用在相空间某点时发生了什么。任取相空间某点$(q,p)$，用$g^{(t_{},t_{0})}$作用在上面，就相当于将Hamiltonian $H(q,p,t)$中的先“调成”$t_{0}$，然后用这个Hamiltonian从$t_{0}$时刻开始将$(q,p)$演化成另一点。对空间中每一点操作构成一个映射，定义为$g^{t,t_{0}}$。我们可以看到，当Hamiltonian显含时间时，将$t$先“调成”$t_{0}$这步操作非常重要。


>[!Proposition 1]
>If $\frac{\partial H}{\partial t}=0$, phase flows constitute a 1-parameter group.
## Handwave
任取一点$(q(t_{0}),p(t_{0}))$，考虑$g^{(t_{1},t_{0})}g^{(t_{2},t_{0})}(q(t_{0}),p(t_{0}))$。

因为$g^{(t_{2},t_{0})}$会将任意从$t_{0}$时刻的点映到$t_{2}$时刻的相应点，$g^{(t_{1},t_{0})}$会将任意从$t_{0}$时刻开始的点映到时刻的相应点。于是$g^{(t_{2},t_{0})}$在初始时将Hamiltonian中时间先调成$t_{0}$，然后将$(q(t_{0}),p(t_{0}))$演化到$(q(t_{2}),p(t_{2}))$。

再用$g^{(t_{1},t_{0})}$对作映射。这又会将Hamiltonian中时间在初始时调成$t_{0}$。但这没用，因为$\frac{\partial H}{\partial t}=0$。所以这个算子等价于$g^{(t_{1}-t_{0}+t_{2},t_{2})}$。

而显然：
$$g^{(t_{1}-t_{0}+t_{2},t_{2})}g^{(t_{2},t_{0})}=g^{(t_{2}+t_{1}-2t_{0},t_{0})}$$
我们发现初始时间$t_{0}$不重要，重要的仅仅是演化的时间。于是记$g^{(t+t_{0},t_{9})}$为$g^{t}$。

取$q^0=\mathbb{1}$为单位元。显然任取$g^{t}$，我们有：
$$g^{-t}g^{t}=\mathbb{1}$$
这是因为Hamilton方程的可逆性。
>[!Right]
>$\blacksquare$

>[!Notation 1]
>If $\frac{\partial H}{\partial t}=0$, denote $g^{(t+t_{0},t_{0})}:=g^{t}$.

**我们下面的讨论都将局限在$\frac{\partial H}{\partial t}=0$的情况下。即系统为封闭系统。**

>[!Lemma 1]
>Let $g\in C^1$ be a homeomorphism $\mathbb{R}^n\rightarrow \mathbb{R}^n$, $f\in L^1(\mathbb{R}^n)$ be a function, $M\subset \mathbb{R}^n$ be a Lebesgue-measurable set. Then:
>$$\int_{g(M)}d^nxf(x)=\int_{x\in M}d^n(g(x))f(g(x))=\int_{x\in M}d^nx|\det(g)|f(g(x))$$

>[!Theorem 1]
>Let $M$ be Lebesgue-measurable. Then $m(M)=m(g^{t}M),\forall t$.
## Proof.
我们任取可测集$M$。
$$\begin{align}
\text{RHS} & = m(g^t(M)) \\
 & = \int_{g^t(M)}dqdp \\
 & = \int_{(q,p)\in M}d(g^tq)d(g^tp) 
 \\ & =\int_{M} \frac{\partial(g^tq,g^tp)}{\partial(q,p)}dqdp
\end{align}$$
因为我们想用上Hamilton方程。我们希望出现正则坐标的时间导数。但是上式没有。我们发现要证theorem 1，即证$\frac{d}{dt}(m\circ g^t(M))=0$。

于是：
$$\begin{align}
\frac{d}{dt}(m\circ g^t(M) ) & =\frac{d}{dt}\int_{M} \frac{\partial(g^tq,g^tp)}{\partial(q,p)}dqdp \\
 &= \int_{M} \frac{\partial}{\partial t}\left(  \frac{\partial(g^tq_{},g^tp)}{\partial(q,p)} \right)dqdp
\end{align}$$
不妨记$q^{'}=g^tq,p^{'}=g^tp$。并将一套正则坐标统一记为$(q,p)=\eta,(q^{'},p^{'})=\eta^{'}$。则Jacobian的时间导为：
$$\begin{align}
\frac{\partial}{\partial t}\left(  \frac{\partial(q^{'},p^{'})}{\partial(q,p)} \right) & = \frac{\partial}{\partial t}\left( \frac{\partial(\eta_{1}^{'},\dots,\eta_{N}^{ '})}{\partial(\eta_{1},\dots,\eta_{N})} \right) \\
 & = \sum_{j} \frac{\partial(\eta_{1}^{'},\dots,\partial\eta^{'}_{j} / \partial t,\dots,\eta^{'}_{N})}{\partial(\eta_{1},\dots ,\eta_{N})}
\end{align}$$
这是因为Jacobian是一个determinant。而determinant是矩阵元的多项式。由多项式的符合求导，可以得到上式。你可以用$N$元permitation展开看一下就很明显了。

**Caveat:千万不要写成$\frac{\partial}{\partial t}\left( \frac{\partial(\eta_{1}^{'},\dots,\eta_{N}^{ '})}{\partial(\eta_{1},\dots,\eta_{N})} \right) \\= \frac{\partial(\partial\eta_{1}^{'} / \partial t,\dots,\partial\eta^{'}_{j} / \partial t,\dots,\partial\eta^{'}_{N} / \partial t)}{\partial(\eta_{1},\dots ,\eta_{N})}$

而由于：
$$\frac{\partial}{\partial \eta_{k}}\left(  \frac{\partial \eta_{j}^{'}}{\partial t} \right)=\sum_{l}\frac{\partial \eta_{l}^{'}}{\partial \eta_{k}} \frac{\partial }{\partial \eta_{l}^{'}}\left(  \frac{\partial \eta_{j}^{'}}{\partial t} \right)$$
所以Jacobian中第$j$行就都长这样。我们可以根据determinant的线性性将求和移到外面：
$$\begin{align}
\sum_{j} \frac{\partial(\eta_{1}^{'},\dots,\partial\eta^{'}_{j} / \partial t,\dots,\eta^{'}_{N})}{\partial(\eta_{1},\dots ,\eta_{N})} 
 & = \sum_{j,l} \frac{\partial}{\partial \eta_{l}^{'}} \frac{\partial \eta_{j}^{'}}{\partial t} \frac{\partial(\eta_{1}^{'},\dots,\eta^{'}_{l} ,\dots,\eta^{'}_{N})}{\partial(\eta_{1},\dots ,\eta_{N})}
\end{align}$$
由行列式性质，我们知道除非$l=j$，不然行列式为零。所以：
$$\sum_{j,l} \frac{\partial}{\partial \eta_{l}^{'}} \frac{\partial \eta_{j}^{'}}{\partial t} \frac{\partial(\eta_{1}^{'},\dots,\eta^{'}_{l} ,\dots,\eta^{'}_{N})}{\partial(\eta_{1},\dots ,\eta_{N})}=\left(\sum_{j} \frac{\partial  \dot{\eta}_{j}^{'}}{\partial \eta_{j}^{'}}\right) \frac{\partial(\eta_{1}^{'},\dots,\eta_{N}^{N})}{\partial(\eta_{1},\dots,\eta_{N})}$$
接下来容易看出：
$$\begin{align}
\sum_{j} \frac{\partial  \dot{\eta}_{j}^{'}}{\partial \eta_{j}^{'}} & =\sum_{i} \left(\frac{\partial^{2}H}{\partial q_{i}\partial p_{j}}- \frac{\partial^{2}H}{\partial q_{i}\partial p_{j}  }\right)=0
\end{align}$$
>[!Right]
>$\blacksquare$
# 2. Surface measure on level sets

>[!Definition 1]
>Let $f(q,p)$ be a function of the microstates. Then if the quantity below exists, define it as the time average starting from $(q(0),p(0))$:
>$$\bar{f}=\lim_{ T \to \infty }\int_{0}^Tdtf(q(t),p(t)) $$

>[! Theorem 1]
>Let $f$ be an integrable function. Then:
>$$\bar{f}\text{ exists for }(q(0),p(0))\text{ Lebesgue-a.e.} $$

>[!Theorem 2]
>If $(q(0),p(0)),(q^{'}(0),p^{'}(0))$ belong to the same trajectory, and their time averages are defined. Then:
>$$\bar{f}\text{ starting from }(q(0),p(0))=\bar{f}\text{ starting from }(q^{'}(0),p^{'}(0))$$

所以时间平均不依赖于特定的起始点，只依赖于trajectrory。

>[! Proposition 1]
>Let $H(q,p)$ be the energy, $f(q,p)$ be integrable. Let $\Sigma_{E}= \{ (q,p)|H(q,p)\leq E \}$. Then:
>$$\frac{d}{dE}\int_{\Sigma_{E}}dm f=\int_{\partial \Sigma_{E}}dS \frac{f}{|\nabla H|}$$
>
## Handwave
我们将空间分成无数个等能量面构成的有些许厚度的“壳”。在空间中任意一点，对于体元$d\Omega$，我们不妨设：
$$dm=dSdn$$
其中$dS$为该点对应的等能量面的面元，$dn$为该点对应的等能量面的面元垂直方向的线元。

设$d\vec{n}$的首端对应的等能量面能量为$E$，末端对应的等能量面能量为$E+dE$。我们有理由认为$dE$和$dn$有关系。因为显然$d\vec{n}$越长，两个面差的能量越多。

那么$d\vec{n}$和$E$具体如何联系呢？因为$d\vec{n}$会引出每个坐标$\vec{\eta}=(q,p)$的变化，而$\vec{\eta}$的变化会引起$H(q,p)$的变化，从而引起能量的变化。具体来说，$d\vec{n}$引出$\eta_{i}$的变化为：
$$d \eta_{i}=d\vec{n}\cdot  \hat{\eta}_{i}$$
而所有$d\eta_{i}$引出的能量变化为：
$$\begin{align}
dE= \frac{\partial H}{\partial \eta_{i}}d \eta_{i}= \frac{\partial H}{\partial \eta_{i}} d\vec{n} \cdot  \hat{\eta}_{i}
\end{align}$$
我们又知道，$d\vec{n}$的方向由$\nabla H$给出：
$$\hat{n}= \frac{\nabla H}{|\nabla H|}$$
于是：
$$\begin{align}
dE & = \frac{\partial H}{\partial \eta_{i}}d\vec{n}\cdot  \hat{\eta}_{i} \\
 & = \frac{\partial H}{\partial \eta_{i}}dn \frac{\nabla H}{|\nabla H|} \cdot  \hat{\eta}_{i} \\
 & = dn \frac{\partial H}{\partial \eta_{i}} \frac{\partial H / \partial \eta_{i}}{|\nabla H|}  \\
 & =dn \frac{1}{|\nabla H|} \left(  \frac{\partial H}{\partial \eta_{i}} \right)^{2} \\
 & = dn \frac{1}{|\nabla H|}|\nabla H |^{2} \\
 & = dn |\nabla H|
\end{align}$$
所以我们有：
$$dm=dndS= \frac{dEdS}{|\nabla H|}$$
于是显然：
$$\begin{align}
\frac{d}{dE}\int_{\Sigma_{E}}d\Omega f & =\frac{d}{dE}\int_{\Sigma_{E}} \frac{dE^{'}dS}{|\nabla H|}f \\ & =\frac{d}{dE}\int_{0}^{E}dE^{'} \int_{\partial \Sigma_{E^{'}}} dS \frac{f}{|\nabla H|} \\

 & = \int_{\partial \Sigma_{E}} dS \frac{f}{|\nabla H|}
\end{align}$$
>[!Right]
>$\blacksquare$

考虑一等能量面$\partial \Sigma_{E}$。该面显然在$g^t$的映射下不变。令$M$为该面上一可测集。那么我们可以自然地定义一个$M$的测度$\mu(M)=\int_{M}dS$。但是$\mu(M)$不再是不变的了！这是因为$\int_{M}dS$不是一个$\mathbb{R}^{6N}$上的Lebesgue测度。具体来说，我们考虑如下情形：

在$\mathbb{R}^{6N}$上取一集合$U$，使得$U \cap \partial \Sigma_{E}=M$。那么在$m(g^tU)$应当不变。但是$U$可能一直在变形，$M$可能变得时大时小。

那么我们想再定义一个不变的测度。我们考虑从$M$每个点作垂线，交临近的等能量面$\partial \Sigma_{E+dE}$。将形成的的区域记为$D$。那么$m(g^tD)$是不变的。

**Caveat: 在时间演化之后，原先从$M$作的垂线一般来说就不再垂直了。所以$D$不总是长得像一小截圆柱体一样。**

那么下式是一个不变量：
$$\begin{align}
m(D) & = d \int_{\Sigma_{E}}dm \mathbb{1}_{D} \\
 & = dE \int_{\partial \Sigma_{E}}dS \frac{\mathbb{1}_{D}}{|\nabla H|} \\
 & = dE\int_{M}dS \frac{1}{|\nabla H|}
\end{align}$$
而因为在phase flow中，相点都在各自的等能量面上流动。面$\partial \Sigma_{E+dE},\partial \Sigma_{E}$之间能量差$dE$总是不变，所以：
$$\int_{M}dS \frac{1}{|\nabla H|}\text{ is }g^{t}\text{-invariant}$$
>[!Definition 2]
>Define the surface measure on level sets of $H$ as:
>$$d\Omega=dS \frac{1}{|\nabla H|}$$
>where $dS$ is the Lebesgue measure of surface elements.

>[!Proposition 2]
>$$\Omega(\partial \Sigma_{E})= \frac{d}{dE}m(\Sigma_{E})$$

^proposition22
## Proof.
$$\begin{align}
\frac{d}{dE}m(\Sigma_{E}) & =\frac{d}{dE} \int_{\Sigma_{E}}dm \\
 & = \frac{d}{dE} \int_{0}^{E}dE^{'} \int_{\partial \Sigma_{E}} dS\frac{1}{|\nabla H|} \\
 & = \int_{\partial \Sigma_{E}}dS \frac{1}{|\nabla H|} \\
 & = \Omega(\partial \Sigma_{E})
\end{align}$$
>[!Right]
>$\blacksquare$
## Ex:
考虑一个三维球$H=x^{2}+y^{2}+z^{2}=1$。那么：
$$|\nabla H|=|2x \hat{x}+2y \hat{y}+ 2z \hat{z}|=2$$
所以水平集测度为：
$$d\Omega= \frac{dS}{2}$$
用它来测球面得到：
$$\begin{align}
\Omega(\{ \text{unit sphere} \}) & = \int_{0}^{2\pi}d\phi \int_{0}^{\pi}\sin \theta d\theta \frac{1}{2} \\
 & = 2\pi
\end{align}$$
考虑球的Lebesgue测度：
$$m(\{ \text{ball with radius }\sqrt{ E } \})= \frac{4}{3}\pi E^{3/2}$$
所以：
$$\left.\frac{\partial}{\partial E}\left(  \frac{4}{3}\pi E^{3/2} \right)\right|_{E=1}= 2\pi$$
与水平集测度测球面相等。

>[!Corollary 1]
>$$\int_{\partial \Sigma_{E}} \frac{dS}{|\nabla H|}f= \frac{d}{dE}\int_{\Sigma_{E}} dm f$$
## Proof.
观察[[统计力学的数学基础^proposition22|proposition 2.2]]的证明，我们发现integrand里面放一个$f$什么都不会影响。
>[!Right]
>$\blacksquare$

>[!Corollary 2]
>Let $f=f(H)$ be a function of the Hamiltonian. Then: 
>$$\int_{E_{1}<H<E_{2}}dmf(H)=\int_{E_{1}<H<E_{2}}dH \int_{\partial \Sigma_{E}}d\Omega f(H)$$
## Remark
注意我写$E_{1}<H<E_{2}$时有两种含义。一种是指$\{ (q,p)|E_{1}<H(q,p)<E_{2} \}$。另一种是指$(E_{1},E_{2})$。两种含义应该在各自的语境下比较trivial。
## Proof.
$$\begin{align}
\int_{E_{1}<E<E_{2}}dmf(H) & =\int_{E_{1}<H<E_{2}}dndS f(H) \\
 & = \int_{E_{1}<H<E_{2}} |\nabla H |dn \frac{dS}{|\nabla H|}f(H) \\
 & = \int_{E_{1}<H<E_{2}} dHd\Omega f(H)
\end{align}$$
>[!Right]
>$\blacksquare$
# 3. Number of states

>[!Definition 1]
>Given an isolated system with $E=H$, define the number of states function as:
>$$\Omega(\Sigma_{E})$$
>Sometimes write $\Omega(E)$.

考虑一个封闭系统。其Hamiltonian为$H=H(\vec{\eta})$。若$\exists \vec{\eta_{1}}, \vec{\eta}_{2}\text{ s.t. }\vec{\eta}=(\vec{\eta_{}}_{1},   \vec{\eta}_{2}),\text{ and }H=H_{1}(\vec{\eta}_{1})+H_{2}(\vec{\eta}_{2})$，那么这个系统可以看作由两个抽象的子系统组成。我们称这个系统有两个子系统组成。

>[!Definition 2]
>Let $H=H(q,p)$ be the Hamiltonian of the system. We say that the system consists of two subsystems if:
>- $\exists(q_{1},p_{1}),(q_{2},p_{2})\text{ s.t. }(q_{1},p_{1})\times(q_{2},p_{2})=(q,p)$
>- $\exists H_{1}(q_{1},p_{1}),H_{2}(q_{2},p_{2})\text{ s.t. }H=H_{1}+H_{2}$
## Ex:
考虑二维谐振子$H= \frac{p_{x}^{2}}{2m}+ \frac{p_{y}^{2}}{2m}+ \frac{1}{2}m\omega_{x}x^{2}+ \frac{1}{2}m\omega_{y}y^{2}$。我们可以作如下分解：
$$H=\left(  \frac{p_{x}^{2}}{2m}+ \frac{1}{2}mx^{2} \right)+ \left(  \frac{p_{y}^{2}}{2m} + \frac{1}{2}my^{2}\right)=H_{x}+H_{y}$$
它可以抽象地看作两个一维谐振子组成的系统。

## Ex:
考虑两箱相互接触的理想气体。因为接触面是二维的，两箱气体相互作用的分子无穷少。所以不存在interaction term。因此若Hamiltonian分别为$H_{1},H_{2}$，则系统总Hamiltonian为$H=H_{1}+H_{2}$。所以反过来说，系统显然是由两个子系统组成的。

>[!Lemma 1]
>Let $\mathbb{R}^{2}$ be the product measure space of $\mathbb{R},\mathbb{R}$ with measures $m_{1},m_{2}$. Let $m=m_{1}\otimes m_{2}$ be the product measure. Then:
>$$m(M)=\int m_{2}(E_{x})dm_{1}(x)=\int dm_{1}(x)\int_{E_{x}}dm_{2}(y)$$

^40547d
## Proof.
见Folland pp.66 theorem 2.36证明。
>[!Right]
>$\blacksquare$


>[!Proposition 1]
>Let the system consist of subsystems $1,2$. If we fix the total energy $E$ of the system, we have:
>$$\Omega(E)=\int d\epsilon\Omega_{1}(\epsilon)\Omega(E-\epsilon)$$
>
## Proof.
我们发现整个系统的每个microstate $(q,p)$已经被拆为：
$$(q,p)=(q_{1},p_{1})\times(q_{2},p_{2})$$
所以由[[统计力学的数学基础#^40547d|lemma 3.1]]，我们知道：
$$\begin{align}
m(\Sigma_{E}) & =\int_{\Sigma_{E_{}}} dm_{1}\int_{\Sigma_{E-\epsilon}}dm_{2} \\
 & = \int_{\Sigma_{E}}dm_{1}m_{2}(\Sigma_{E-\epsilon}) \\
 & = \int_{\Sigma_{E}} d\Omega_{1}d\epsilon m_{2}(\Sigma_{E-\epsilon}) \\
 & = \int_{0}^{E}d\epsilon \int_{\partial \Sigma_{\epsilon}} d\Omega_{1}m_{2}(\Sigma_{E-\epsilon})
\end{align}$$
 因为$m_{2}(\Sigma_{E-\epsilon})=0,\text{ for }\epsilon>E$。所以：
 $$\begin{align}
m(\Sigma_{E}) & =\int_{0}^{\infty}d\epsilon \int_{\partial \Sigma_{\epsilon}}d\Omega_{1}m_{2}(\Sigma_{E-\epsilon}) \\
 \implies & \frac{d}{dE}m(\Sigma_{E})= \frac{d}{dE} \int_{0}^{\infty}d\epsilon \int_{\partial \Sigma_{\epsilon}}d\Omega_{1}m_{2}(\Sigma_{E-\epsilon}) \\
\implies & \Omega(E)= \int_{0}^{\infty}d\epsilon\int_{\partial \Sigma_{\epsilon}}d\Omega_{1} \Omega_{2}(E-\epsilon)=\int_{0}^{\infty}d\epsilon \Omega_{1}(\epsilon)\Omega_{2}(E-\epsilon)
\end{align}$$

>[!Right]
>$\blacksquare$

# ???
因为Lebesgue测度是一个空间上可测集到$\mathbb{R}$的函数。因为空间变换，了，所有点发生一个变换，导致可测集也发生变换。我们必须认为存在一个“可测集实体”不变。它由“矢量实体”代表的点构成。我们还要认为存在一个“测度实体”不变。但是因为由可测点表示构成的可测集表示不停地在变化，测度的functional dependence必须要发生一个变化得到一个新的测度的表示。

考虑某个Lebesgure-measurable set $M$。我们可以对它作一个变换$M\mapsto g^{t}M$。我们可以用Lebesgue测度测它得到$m(M),m(g^{t}M)$。显然固定$t$，$m\circ g^t$是一个新的长得像测度的玩意。实际上我们可以证明它是一个测度：

>[!Proposition 2]
>$m\circ g^t$ is a measure.
>
## Proof.
任取disjoint可测集$M_{1},M_{2}$。我们假设$g^t$的性质足够好，以至于将可测集映到可测集，我们有：
$$\begin{align}
m\circ g^t(M_{1} \sqcup M_{2} ) & =m(g^t(M_{1})\sqcup g^t(M_{2})) \\
  & = m\circ g^t(M_{1})\sqcup m\circ g^t(M_{2})
\end{align}$$
>[!Right]
>$\blacksquare$

我们发现，其实这个测度$m\circ g^t$就是Lebesgue测度。

>[!Theorem 1]
>$$m\circ g^t=m,\forall t\in \mathbb{R}$$