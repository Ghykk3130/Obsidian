# 前置讨论

当电荷（或者电流）相集中地分布在一小块区域时，我们计算标势（或者矢势）时的积分区域会很小。（我们一般对势进行展开，因为对于标势，不会涉及到矢量，对于矢势，不会涉及到叉乘。势总是比场简单。先算势再算场是一种场论的哲学。）我们只会积那一小块有电荷分布的区域。 这个时候精确地carry out这个积分不太划算。我们可以更简洁地对integrand作近似再积分。

多元Taylor展开： 

1） $f(\vec{r}+d \vec{r})=f(\vec{r})+d \stackrel{\rightharpoonup}{r} \cdot \nabla f(\vec{r})+d \vec{r} d \vec{r}: \nabla \nabla f(\vec{r})+\cdots$ 注意此处求完导之后应带入的是$\vec{r}$而不是$\vec{r} + d\vec{r}$ 

# 静电场多极展开

无需多言。我们展开两项（我们将带电体放在原点）：

2） $\begin{aligned} V(\vec{r})=\frac{1}{4 \pi \varepsilon_0} \int \frac{\rho d \tau}{\left|\vec{r}-\vec{r}^{\prime}\right|} & \approx \frac{1}{4 \pi \varepsilon_0} \int \frac{\rho d \tau}{r}+\left(-\vec{r}^{\prime}\right) \cdot \nabla \frac{\rho d \tau}{r} \\ & =\frac{1}{4 \pi \varepsilon_0} \int \frac{\rho d \tau}{r}+\vec{r}^{\prime} \cdot \frac{\hat{r} \rho d \tau}{r^2} \\ & =\frac{1}{4 \pi \varepsilon_0} \frac{Q}{r}+\frac{1}{4 \pi \varepsilon_0} \frac{\hat{r}}{r^2} \cdot \vec{p}\end{aligned}$ ^bda914

注意上面不要对于$\vec{r}^{'}$求导，因为我们已经将$\vec{r} - \vec{r}^{'}$当成了整体。
我们可以求一下导 以获得场：

2） $\vec{E}_0=-\nabla\left(\frac{1}{4 \pi \varepsilon_0} \frac{Q}{r}\right)=\frac{1}{4 \pi \varepsilon_0} \frac{Q}{r^2}$

   $\begin{aligned} \vec{E}_1 & =-\nabla\left(\frac{1}{4 \pi \varepsilon_0} \frac{\hat{r}}{r^2} \cdot \vec{p}\right) \\ & =-\frac{\vec{p}}{4 \pi \varepsilon_0} \cdot \nabla\left(\frac{\hat{r}}{r^2}\right) \\ & =  \frac{1}{4\pi \epsilon_{0}} \frac{3\hat{r}(\hat{r}\cdot \hat{p})-\hat{p}}{r^3}\end{aligned}$

计算$\nabla(\frac{\hat{r}}{r^2})$ 建议用分量写开（注意这里不能用球坐标del算子。因为虽然看似括号里的玩意与$\theta, \phi$无关，但因为方向在变化，其实是有关的。求导永远是既对分量求，又对分量对应的基矢量求的。我们还是用Cartesian coordinates老老实实计算。）。只需要注意中间在算到这一步时，想要得到RHS需要对$i,j$分类讨论：

$\partial_i\left(\frac{r_j}{r^3}\right)=\frac{1}{r^3} \delta_{i j}-\frac{3 r_i r_j}{r^5}$

值得注意的是，电偶极矩是一个矢量，电四极矩就是一个二阶张量。（这里我们没算电四极矩）

# 电偶极矩与外场的作用

上面我们计算了小电荷分布自己产生的势与场。接下来计算小电荷分布与外场的作用。我们考虑电偶极矩在外场中的受力，能量与力矩。我们的思路是先考虑受力，然后再计算这个力的功获得能量。有了受力自然也可以计算力矩。

我们同样需要假设带电体足够小，以至于能够Taylor展开。

无需多言。开始计算：

1） $\begin{aligned} \vec{F} & =\int \rho d \tau \vec{E}\left(\vec{r}_0+\vec{r}^{\prime}\right) \approx \int \rho d \tau\left(\vec{E}\left(\vec{r}_0\right)+\vec{r}^{\prime} \cdot \nabla \vec{E}\left(\vec{r}_0\right)\right) \\ & =q \vec{E}+\vec{p} \cdot \nabla \vec{E}\end{aligned}$ 

这是外场对偶极的力。
## Caveat
一般地，有两种描述偶极的方式。
- 将偶极当做偶极分布。则偶极分布具有五个自由度。三个平动自由度表示偶极的位置，两个角度的自由度表示偶极的orientation。一般偶极分布可以写为：
$$\vec{p}(\vec{r},\theta,\phi)=\delta(\vec{r}-\vec{r}_{0})p\hat{n}(\theta,\phi)$$
  其中$\vec{r}_{0}$为偶极所在位置。
- 将偶极当做一个单粒子矢量，默认它的位置已经implicit地给出。则偶极只有两个描述orientaion的自由度。我们写：
$$\vec{p}(\theta,\phi)=p\hat{n}(\theta,\phi)$$
我们注意，在第一种描述中，$\vec{p}\cdot \nabla \vec{E} \neq \nabla(\vec{p}\cdot \vec{E})$。这是因为$\vec{p}$中含有$\vec{r}$的dependence

但是在推导$\vec{F}=q\vec{E}+\vec{p}\cdot \nabla \vec{E}$时，我们用的是第二种描述。位置的dependence已经被我们积分积掉了。于是我们可以这样写：
$$\vec{p}\cdot \nabla \vec{E}=\nabla(\vec{p}\cdot \vec{E})$$


将偶极搬运到外场中需要相反地力做功。于是偶极在外场中的能量为：$-\int \vec{F} \cdot d\vec{r}$ 。

2） $\begin{aligned} W & =-\int(q \vec{E}+\vec{p} \cdot \nabla \vec{E}) \cdot d \vec{r} \\ & =-\int q(-\nabla V) \cdot d \vec{r}-\int(\vec{p} \cdot \nabla \vec{E}) \cdot d \vec{r} \\ & =q V-\int \nabla(\vec{p} \cdot \vec{E}) \cdot d \vec{r} \\ & =q V-\vec{p} \cdot \vec{E}\end{aligned}$ 

最后一个等号是因为$\vec{E}$在$\infty$消失了。 注意到当$\vec{p}$和$\vec{E}$ align的时候能量是更小的。

接下来计算力矩（这个力矩是针对这个电荷分布内的任意一点的。反正这个电荷分布很小，里面随便选一点都差不多）：

3） $\begin{aligned} \vec{\tau} & =\int \vec{r}^{\prime} \times \rho d r \vec{E}\left(\vec{r}_0+\vec{r}^{\prime}\right) \\ & =\int \vec{r}^{\prime} \times \rho d r\left(\vec{E}\left(\vec{r}_0\right)+\vec{r}^{\prime} \cdot \nabla \vec{E}\left(\vec{r}_0\right)\right) \\ & =\vec{p} \times \vec{E}\end{aligned}$

>[! Remark]
> 我们发现，其实受力和能量都是在点电荷基础上加上一“微扰项”。如果电荷分布地无限集中，那么系统退化成一个点电荷。相应的$\vec{p}$退化成零。这个时候偶极子造成的微扰项也就退化成零了。受力和能量就是纯粹的点电荷的受力和能量。同时因为电荷分布地无限集中，那么就没有几何结构，不会受力矩。这也就是点电荷受的力矩。

>[! Proposition 1]
>An appropriate Hamiltonian for an electric dipole in electric field is:
>$$H=-\vec{p}(\theta,\phi)\cdot \vec{E}  (\vec{r})$$
## Proof.
我们需要验证这个Hamiltonian满足正则方程。Want：
$$\frac{\partial H}{\partial r_{i}}=-\dot{p}_{i}$$
$$p_{i}=m  \dot{r}_{i} \implies  - \frac{\partial H}{\partial r_{i}}=F_{i}$$
这就是说，我们对平动坐标微分取负应当得到驱动平动坐标运动的力。这显然是正确的。因为：
$$\begin{align}
- \frac{\partial H}{\partial r_{i}} & = p_{j}\partial_{i}E_{j} \\
 & =F_{i}
\end{align}$$

# 静磁场多级展开

同样地，我们假设电流分布在原点周围，然后对矢势作偶极近似：

·4） $\begin{aligned} \vec{A}(\vec{r}) & =\frac{\mu_0}{4 \pi} \int \frac{\vec{J}\left(\vec{r}^{\prime}\right) d \tau}{\left|\vec{r}-\vec{r}^{\prime}\right|} \\ & \approx \frac{\mu_0}{4 \pi} \int \vec{J} d \tau\left(\frac{1}{r}+\left(-\frac{\vec{r}}{r^2}\right) \cdot\left(-\vec{r}^{\prime}\right)\right) \\ & =\frac{\mu_0}{4 \pi} \int \frac{\vec{J}}{r} d \tau+\frac{\mu_0}{4 \pi} \int d r \vec{J} \frac{\vec{r}}{r^3} \cdot \vec{r}^{\prime}\end{aligned}$

第一项$\vec{A}_{0} = \frac{\mu_0}{4\pi} \int \frac{\vec{J}}{r}d\tau$非常平凡，就是把总电流集中在原点产生的矢势。我们研究第二项。我们希望将第二项和电偶极一样，写成和磁偶极有关的一个东西。我们需要下面两个式子

5）$\nabla^{'}\cdot(\vec{J}(\vec{r}^{'})r_l^{'}r_{k}^{'}) = (\nabla^{'} \cdot \vec{J}) r_l^{'}r_k^{'} + \vec{J} \cdot(\nabla^{'}r_l^{'})r_k^{'} + \vec{J}\cdot r_l^{'}(\nabla^{'}r_k^{'}) = J_{l}r_k^{'} +J_{k} r_l^{'}$ 

$\vec{J}$没有散度是因为steady state current，$\frac{\partial \rho}{\partial t} = \nabla \cdot \vec{J} = 0$ 

6）$\epsilon_{lki}(\vec{r}^{'} \times \vec{J})_{i} = \epsilon_{lki} \epsilon_{isj} r_{s}^{'}J_{j} = \epsilon_{ilk} \epsilon_{isj} r_{s}^{'}J_{j} = (\delta_{ls}\delta_{kj} - \delta_{lj}\delta_{ks})r_{s}^{'}J_{j} = r_{l}^{'}J_k - r_{k}^{'}J_{l}$ 

然后，4）的第二项为：

$\overrightarrow{A_1}=\frac{\mu_0}{4 \pi} \int d \tau \stackrel{\rightharpoonup}{J} \vec{r}^{\prime} \cdot \frac{\stackrel{\rightharpoonup}{r}}{r^3}$

用分量写开：

$\begin{aligned} A_{1 k} & =\frac{\mu_0}{4 \pi} \int d \tau J_k r_l^{\prime} \frac{r_l}{r^3} \\ & =\frac{\mu_0}{4 \pi}\left(\int_0 d \tau J_k r_l^{\prime}\right) \frac{r_l}{r^3} \\ & =\frac{\mu_0}{4 \pi} T_{k l} \frac{r_l}{r^3}\end{aligned}$

我们主要想知道中间那个积分表示的二阶张量是什么。注意到5）+6）再除以二可以得到integrand。于是：

$\begin{aligned} T_{k l} & =\int d r \frac{1}{2}\left(\nabla^{\prime} \cdot\left(\vec{J} r_l^{\prime} r_k^{\prime}\right)+\varepsilon_{l k i}\left(\vec{r}^{\prime} \times \vec{J}\right)_i\right) \\ & =\frac{1}{2} \oint d \vec{a} \cdot (\vec{J} r_l^{\prime} r_k^{\prime})+\frac{1}{2} \int d r \varepsilon_{l k i}\left(\vec{r}^{\prime} \times \vec{J}\right)_i \\ & =\frac{1}{2} \int d r \varepsilon_{l k i}(\vec{r} \times \vec{J})_i \\ & =\varepsilon_{l k i} m_i\end{aligned}$

其中面积分消失了是因为我们取到正无穷去了，integrand在无穷处消失了。

>[! Proposition 1]
>$\int d^{3}rJ_{k}(\vec{r})r_{l}=  -\frac{1}{2}\epsilon_{ikl}\int d^{3}r(\vec{r}\times \vec{J}(\vec{r}))_{i}$

## Remark
我们把撇去掉以获得更一般性的结论。你会发现有没有撇证明是一样的，关键在于$\vec{J}$是$\vec{r}$还是$\vec{r}^{'}$的函数。


于是我们得到了：

$\begin{aligned} & A_{1 k}=\frac{\mu_0}{4 \pi} \varepsilon_{l k i} m_i \frac{r_l}{r^3}=\frac{-\mu_0}{4 \pi} \varepsilon_{k l i} m_i \frac{r_l}{r^3} \\ & \Rightarrow \vec{A}_1=-\frac{\mu_0}{4 \pi} \frac{\vec{m} \times \vec{r}}{r^3}=\frac{\mu_0}{4 \pi} \frac{\hat{r} \times \vec{m}}{r^2}\end{aligned}$

同样和电场一样，我们计算磁场得到：$\vec{B}=\nabla\times  \left( \frac{\mu_{0}}{4\pi}  \frac{\hat{r} \times \hat{m}}{r^2} \right)=  \frac{\mu_{0}}{4\pi} \frac{3 \hat{r}(\hat{r} \cdot \hat{m})-\hat{m}}{r^3}$ 
在采用分量计算时有一个注意点：
>[! Caveat]
>$\sum_{j}\delta_{jj} \neq 1$. Instead, it's equal to $3$.


# 磁偶极矩与外场的作用

我们直接对一个磁偶极子作展开：
$\vec{F}=\int d^3r\vec{J}\times \vec{B}=\int d^3r\vec{J}\times(\vec{B_{0}}+\vec{R}\cdot \nabla \vec{B})$

我们先来处理第一项：$\int d^3r\vec{J}\times \vec{B_{0}}$。我们回忆起对于steady state局域电流，作电流体积分为零。

>[! Proposition 2]
>If $\frac{\partial \rho}{\partial t}=0$, and the current is localized, then
>$\int \vec{J}d^{3}r=0$

## Remark
localized的意思是说电流的分布没有延伸到无限。steady state current的意思是说电流散度为零，电荷分布没有被电流流动改变。形象一点说就是电荷没有被电流带着跑。
## Proof.
我们很想用散度定理。于是我们强行在integrand凑一个$\nabla$出来。

我们发现：$\nabla \cdot(r_{k}\vec{J})=(\nabla r_{k})\cdot\vec{J}+r_{k}(\nabla \cdot \vec{J})=(\nabla r_{k})\cdot\vec{J}=J_{k}$

于是·STS $\int J_{k}d^{3}r=\int \nabla \cdot(r_{k}\vec{J})d^{3}r=\oint r_{k}\vec{J}d^{3}r=0$
我们只需要把面积分区域取到足够大，将整个电流分布都包进去，于是这个面积分便为零了。


回到问题。第一项$\int d^{3}r\vec{J}\times \vec{B_{0}}=\left( \int d^{3}r\vec{J} \right)\times \vec{B_{0}}=0$
于是：
$\vec{F}=\int d^{3}r\vec{J}\times(\vec{R}\times \nabla \vec{B})$
用分量写开就有：$F_{i}=\int d^{3}r\epsilon_{ijk}J_{j}R_{l}\partial_{l}B_{k}=(\int d^{3}r\epsilon_{ijk}J_{j}R_{l})\partial_{l}B_{k}$  将$\partial_{l}R_{l}$提到外面是因为在泰勒展开时，导数已经在电荷分布中心取值带进去了，这里只是一个常数。接下来：

>[! Idea]
>我们发现要引出磁偶极矩，总是要用到proposition 1.


$F_{i}=\epsilon_{ijk}\partial_{l}B_{k}\int d^{3}rJ_{j}R_{l}=\epsilon_{ijk}\partial_{l}B_{k}  (-\frac{1}{2})\epsilon_{sjl}\int d^{3}r(\vec{R}\times \vec{J})_{s}$  (c.f. proposition 1)

$F_{i}=\left( -\frac{1}{2} \right)\partial_{l}B_{k}(\delta_{is}\delta_{kl}-\delta_{il}\delta_{ks})\int d^{3}r(\vec{R}\times \vec{J})_{s}=-\partial_{k}B_{k}m_{i}+\partial_{i}B_{k}m_{k}$
即$\vec{F}=-(\nabla \cdot \vec{B})\vec{m} + \nabla(\vec{m}\cdot \vec{B})=\nabla(\vec{m}\cdot \vec{B})$


因为这个力场旋度为零，自然可以引入一个势。于是令$W =-\vec{m}\cdot \vec{B}$, 则显然$-\nabla W=\vec{F}$

接下来计算力矩：
$\vec{\tau}=\int d^{3}r(\vec{r}-\vec{r_{0}})\times(\vec{J}(\vec{r})\times \vec{B}(\vec{r}))$, where $\vec{r_{0}}$ is an arbitrary point within the dipole.
$\vec{\tau}=\int d^{3}r\vec{R}\times(\vec{J}\times \vec{B})\simeq \int d^{3}r\vec{R}\times(\vec{J}\times \vec{B_{0}})$, 这里只展开到零解，因为零阶没有消失，所以足够了。

$\vec{\tau}\simeq \int d^{3}r((\vec{R}\cdot \vec{B_{0}})\vec{J}-(\vec{R}\cdot \vec{J})\vec{B_{0}})$

第一项：
$\left( \int d^{3}r(\vec{R}\cdot \vec{B_{0}})\vec{J} \right)_{i}=\int d^{3}rR_{j}B_{0j}J_{i}=B_{0j}\int d^{3}rR_{j}J_{i}=B_{0j}\left( -\frac{1}{2} \right)\epsilon_{lij}\int d^{3}r(\vec{R}\times \vec{J})_{l}$ （c.f. proposition 1）
$\implies \int d^{3}r(\vec{R}\cdot \vec{B_{0}})\vec{J}=\vec{m}\times \vec{B_{0}}$

第二项:
$\left( \int d^{3}r(\vec{R}\cdot \vec{J})\vec{B_{0}} \right)_{i}=\int d^{3}rR_{j}J_{j}B_{0i}=B_{0i}\left( -\frac{1}{2} \right)\epsilon_{ljj}\int d^{3}r(\vec{R}\times \vec{J})_{l} = 0$

于是：
$\vec{\tau}=\vec{m} \times \vec{B_{0}}$ , 或写作$\vec{\tau}=\vec{m}\times \vec{B}$



